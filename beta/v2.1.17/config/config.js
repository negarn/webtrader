define(["jquery","windows/windows","common/rivetsExtra","lodash","common/util"],function(a,b,c,d){function e(e){e=a(e).i18n();var g=f(e);i=c.bind(e[0],g),h=b.createBlankWindow(e,{title:"Change Backend Server".i18n(),resizable:!1,collapsable:!1,minimizable:!1,maximizable:!1,modal:!0,ignoreTileAction:!0,open:function(){var a=local_storage.get("config");a&&a.app_id&&(g.app_id=a.app_id),a&&a.websocket_url&&(g.websocket_url=d.replace(d.replace(a.websocket_url||"","wss://",""),"/websockets/v3?l=EN","")),a&&a.oauth_url&&(g.oauth_url=d.replace(d.replace(a.oauth_url||"","https://",""),"/oauth2/authorize",""))},close:function(){i&&i.unbind(),h&&h.dialog("destroy").remove(),i=h=null},buttons:[{text:"Apply".i18n(),icons:{primary:"ui-icon-check"},click:g.apply},{text:"Reset to Defaults".i18n(),icons:{primary:"ui-icon-refresh"},click:g.reset}]}),h.dialog("open")}function f(){var b={websocket_url:"ws.binaryws.com",oauth_url:"oauth.binary.com",app_id:""};return b.apply=function(){var a={websocket_url:"wss://"+b.websocket_url+"/websockets/v3?l=EN",oauth_url:"https://"+b.oauth_url+"/oauth2/authorize",app_id:b.app_id};local_storage.set("config",a),b.reload_page()},b.reset=function(){local_storage.remove("config"),b.reload_page()},b.reload_page=function(){a.growl.notice({message:"Config changes successful.<br/>Reloading page ...".i18n()}),setTimeout(function(){window.location.reload()},900)},b}function g(a){a.click(function(){h?h.moveToTop():require(["text!config/config.html"],e)})}require(["text!config/config.html"]),require(["css!config/config.css"]);var h=null,i=null;return{init:g}});