IndicatorBase=function(a,b,c){this.options=b,this.indicatorData=[],this.uniqueID=uuid(),this.indicators=c},IndicatorBase.prototype.addPoint=function(){return[]},IndicatorBase.prototype.update=function(){return[]},IndicatorBase.prototype.toString=function(){return"IndicatorBase"},IndicatorBase.prototype.buildSeriesAndAxisConfFromData=function(a){var b=[];this.indicatorData.forEach(function(a){b.push([a.time,a.value])});var c={axisConf:{id:a.id+"-"+this.uniqueID,title:{text:this.toString(),align:"high",offset:0,rotation:0,y:10,x:30+7.5*this.toString().length},lineWidth:2,plotLines:this.options.levels,plotBands:this.options.plotBands},seriesConf:{id:this.uniqueID,name:this.toString(),data:b,type:"line",yAxis:a.id+"-"+this.uniqueID,color:this.options.stroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle}};return a.onChartIndicator&&(delete c.axisConf,delete c.seriesConf.yAxis,c.seriesConf.onChartIndicator=!0),[c]},IndicatorBase.prototype.getIDs=function(){return[this.uniqueID]},IndicatorBase.prototype.isSameInstance=function(a){return _.isEqual(a.sort(),[this.uniqueID])},WMA=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[];for(var d=0;d<a.length;d++){if(d>=this.options.period-1){for(var e=0,f=d,g=this.options.period;f>=0&&g>=0;g--,f--){var h=c.getIndicatorOrPriceValue(a[f],this.options.appliedTo);e+=h*g}e/=this.options.period*(this.options.period+1)/2,e=toFixed(e,4),this.indicatorData.push({time:a[d].time,value:e})}else this.indicatorData.push({time:a[d].time,value:null});this.priceData.push(a[d])}},WMA.prototype=Object.create(IndicatorBase.prototype),WMA.prototype.constructor=WMA,WMA.prototype.addPoint=function(a){this.priceData.push(a);for(var b=this.indicatorData.length-1,c=this.indicators.getIndicatorOrPriceValue(a,this.options.appliedTo),d=this.options.period*c,e=b,f=this.options.period-1;e>=0&&f>=1;f--,e--){var c=this.indicators.getIndicatorOrPriceValue(this.priceData[e],this.options.appliedTo);d+=c*f}return d/=this.options.period*(this.options.period+1)/2,d=toFixed(d,4),this.indicatorData.push({time:a.time,value:d}),[{id:this.uniqueID,value:d}]},WMA.prototype.update=function(a){var b=this.indicatorData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;for(var c=0,d=b,e=this.options.period;d>=0&&e>=1;e--,d--){var f=this.indicators.getIndicatorOrPriceValue(this.priceData[d],this.options.appliedTo);c+=f*e}return c/=this.options.period*(this.options.period+1)/2,c=toFixed(c,4),this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},WMA.prototype.toString=function(){return"WMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},SMA=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[];for(var d=0;d<a.length;d++){if(d>=this.options.period-1){for(var e=0,f=this.options.period-1;f>=0;f--)e+=c.getIndicatorOrPriceValue(a[d-f],this.options.appliedTo);var g=toFixed(e/this.options.period,4);this.indicatorData.push({time:a[d].time,value:g})}else this.indicatorData.push({time:a[d].time,value:null});this.priceData.push(a[d])}},SMA.prototype=Object.create(IndicatorBase.prototype),SMA.prototype.constructor=SMA,SMA.prototype.addPoint=function(a){this.priceData.push(a);for(var b=0,c=this.options.period-1;c>=0;c--)b+=this.indicators.getIndicatorOrPriceValue(this.priceData[this.priceData.length-1-c],this.options.appliedTo);var d=toFixed(b/this.options.period,4);return this.indicatorData.push({time:a.time,value:d}),[{id:this.uniqueID,value:d}]},SMA.prototype.update=function(a){var b=0,c=this.priceData.length-1;this.priceData[c].open=a.open,this.priceData[c].high=a.high,this.priceData[c].low=a.low,this.priceData[c].close=a.close;for(var d=this.options.period-1;d>=0;d--)b+=this.indicators.getIndicatorOrPriceValue(this.priceData[c-d],this.options.appliedTo);var e=toFixed(b/this.options.period,4);return this.indicatorData[c].value=e,[{id:this.uniqueID,value:e}]},SMA.prototype.toString=function(){return"SMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},EMA=function(a,b,c){IndicatorBase.call(this,a,b,c);for(var d=0;d<a.length;d++)if(d===this.options.period-1){for(var e=0,f=this.options.period-1;f>=0;f--)e+=c.getIndicatorOrPriceValue(a[d-f],this.options.appliedTo);var g=toFixed(e/this.options.period,4);this.indicatorData.push({time:a[d].time,value:g})}else if(d>this.options.period-1){var h=this.indicatorData[d-1].value,i=c.getIndicatorOrPriceValue(a[d],this.options.appliedTo),j=2*i/(this.options.period+1)+h*(1-2/(this.options.period+1));j=toFixed(j,4),this.indicatorData.push({time:a[d].time,value:j})}else this.indicatorData.push({time:a[d].time,value:null})},EMA.prototype=Object.create(IndicatorBase.prototype),EMA.prototype.constructor=EMA,EMA.prototype.addPoint=function(a){var b=this.indicatorData.length-1,c=this.indicatorData[b].value,d=this.indicators.getIndicatorOrPriceValue(a,this.options.appliedTo),e=2*d/(this.options.period+1)+c*(1-2/(this.options.period+1));return e=toFixed(e,4),this.indicatorData.push({time:a.time,value:e}),[{id:this.uniqueID,value:e}]},EMA.prototype.update=function(a){var b=this.indicatorData.length-1,c=this.indicatorData[b-1].value,d=this.indicators.getIndicatorOrPriceValue(a,this.options.appliedTo),e=2*d/(this.options.period+1)+c*(1-2/(this.options.period+1));return e=toFixed(e,4),this.indicatorData[b].value=e,[{id:this.uniqueID,value:e}]},EMA.prototype.toString=function(){return"EMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},TEMA=function(a,b,c){IndicatorBase.call(this,a,b,c),this.ema1=null,this.ema2=null,this.ema3=null,this.ema1=new EMA(a,{period:b.period,appliedTo:b.appliedTo},c);var d=[];this.ema1.indicatorData.forEach(function(a){d.push({time:a.time,close:a.value})}),this.ema2=new EMA(d,{period:b.period,appliedTo:c.CLOSE},c);var e=[];this.ema2.indicatorData.forEach(function(a){e.push({time:a.time,close:a.value})}),this.ema3=new EMA(e,{period:b.period,appliedTo:c.CLOSE},c);for(var f=0;f<a.length;f++){var g=this.ema1.indicatorData[f].value,h=this.ema2.indicatorData[f].value,i=this.ema3.indicatorData[f].value,j=toFixed(3*g-3*h+i,4);this.indicatorData.push({time:a[f].time,value:j||null})}},TEMA.prototype=Object.create(IndicatorBase.prototype),TEMA.prototype.constructor=TEMA,TEMA.prototype.addPoint=function(a){var b=this.ema1.addPoint(a)[0].value,c=this.ema2.addPoint({time:a.time,close:b})[0].value,d=this.ema3.addPoint({time:a.time,close:c})[0].value,e=toFixed(3*b-3*c+d,4);return this.indicatorData.push({time:a.time,value:e}),[{id:this.uniqueID,value:e}]},TEMA.prototype.update=function(a){var b=this.indicatorData.length-1,c=this.ema1.update(a)[0].value,d=this.ema2.update({time:a.time,close:c})[0].value,e=this.ema3.update({time:a.time,close:d})[0].value,f=toFixed(3*c-3*d+e,4);return this.indicatorData[b].value=f,[{id:this.uniqueID,value:f}]},TEMA.prototype.toString=function(){return"TEMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},TRIMA=function(a,b,c){IndicatorBase.call(this,a,b,c);for(var d=0|Math.round((this.options.period+1)/2),e=0;e<a.length;e++)if(e===d-1){for(var f=0,g=d-1;g>=0;g--)f+=c.getIndicatorOrPriceValue(a[e-g],this.options.appliedTo);this.indicatorData.push({time:a[e].time,value:toFixed(f/d,4)})}else if(e>d-1){var h=this.indicatorData[e-1].value,i=c.getIndicatorOrPriceValue(a[e],this.options.appliedTo),j=(h*(d-1)+i)/d;this.indicatorData.push({time:a[e].time,value:toFixed(j,4)})}else this.indicatorData.push({time:a[e].time,value:null})},TRIMA.prototype=Object.create(IndicatorBase.prototype),TRIMA.prototype.constructor=TRIMA,TRIMA.prototype.addPoint=function(a){var b=0|Math.round((this.options.period+1)/2),c=this.indicatorData.length-1,d=this.indicatorData[c].value,e=this.indicators.getIndicatorOrPriceValue(a,this.options.appliedTo),f=(d*(b-1)+e)/b;return f=toFixed(f,4),this.indicatorData.push({time:a.time,value:f}),[{id:this.uniqueID,value:f}]},TRIMA.prototype.update=function(a){var b=0|Math.round((this.options.period+1)/2),c=this.indicatorData.length-1,d=this.indicatorData[c-1].value,e=this.indicators.getIndicatorOrPriceValue(a,this.options.appliedTo),f=(d*(b-1)+e)/b;return f=toFixed(f,4),this.indicatorData[c].value=f,[{id:this.uniqueID,value:f}]},TRIMA.prototype.toString=function(){return"TRIMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},STDDEV=function(a,b,c){_.isUndefined(b.appliedTo)&&(b.appliedTo=c.CLOSE),IndicatorBase.call(this,a,b,c),this.sma=new SMA(a,b,c),this.priceData=[];for(var d=0;d<a.length;d++){if(d>=b.period){for(var e=0,f=this.options.period-1;f>=0;f--)e+=Math.pow(c.getIndicatorOrPriceValue(a[d-f],this.options.appliedTo)-this.sma.indicatorData[d-f].value,2);var g=Math.sqrt(e/(this.options.period-1));this.indicatorData.push({time:a[d].time,value:toFixed(g,4)})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},STDDEV.prototype=Object.create(IndicatorBase.prototype),STDDEV.prototype.constructor=STDDEV,STDDEV.prototype.addPoint=function(a){this.priceData.push(a),this.sma.addPoint(a);for(var b=this.priceData.length-1,c=0,d=this.options.period-1;d>=0;d--){var e=Math.pow(this.indicators.getIndicatorOrPriceValue(this.priceData[b-d],this.options.appliedTo)-this.sma.indicatorData[b-d].value,2);c+=e}var f=toFixed(Math.sqrt(c/(this.options.period-1)),4);return this.indicatorData.push({time:a.time,value:f}),[{id:this.uniqueID,value:f}]},STDDEV.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close,this.sma.update(a);for(var c=0,d=this.options.period-1;d>=0;d--)c+=Math.pow(this.indicators.getIndicatorOrPriceValue(this.priceData[b-d],this.options.appliedTo)-this.sma.indicatorData[b-d].value,2);var e=toFixed(Math.sqrt(c/(this.options.period-1)),4);return this.indicatorData[this.indicatorData.length-1].value=e,[{id:this.uniqueID,value:e}]},STDDEV.prototype.toString=function(){return"STDDEV ("+this.options.period+")"},STDDEV.prototype.buildSeriesAndAxisConfFromData=function(a){var b=IndicatorBase.prototype.buildSeriesAndAxisConfFromData.call(this,a);return b.forEach(function(a){a.axisConf.title.x=30+7.5*this.toString().length}),b},ATR=function(a,b,c){IndicatorBase.call(this,a,b,c),this.tr=[],this.priceData=[];for(var d=0;d<a.length;d++){if(0==d)this.tr.push({time:a[d].time,value:a[d].high-a[d].low});else{var e=c.getIndicatorOrPriceValue(a[d-1],this.options.appliedTo);this.tr.push({time:a[d].time,value:Math.max(Math.max(a[d].high-a[d].low,Math.abs(a[d].high-e)),a[d].low-e)})}if(d>=b.period){var f=(this.indicatorData[d-1].value*(b.period-1)+this.tr[d].value)/b.period;isFinite(f)&&!isNaN(f)&&this.indicatorData.push({time:a[d].time,value:toFixed(f,4)})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},ATR.prototype=Object.create(IndicatorBase.prototype),ATR.prototype.constructor=ATR,ATR.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1,c=this.indicators.getIndicatorOrPriceValue(this.priceData[b-1],this.options.appliedTo),d=Math.max(Math.max(a.high-a.low,Math.abs(a.high-c)),a.low-c),e=toFixed((this.indicatorData[b-1].value*(this.options.period-1)+d)/this.options.period,4);return this.indicatorData.push({time:a.time,value:e}),this.tr.push({time:a.time,value:d}),[{id:this.uniqueID,value:e}]},ATR.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.indicators.getIndicatorOrPriceValue(this.priceData[b-1],this.options.appliedTo),d=Math.max(Math.max(a.high-a.low,Math.abs(a.high-c)),a.low-c),e=toFixed((this.indicatorData[b-1].value*(this.options.period-1)+d)/this.options.period,4);return this.indicatorData[this.indicatorData.length-1].value=e,this.tr[this.indicatorData.length-1].value=d,[{id:this.uniqueID,value:e}]},ATR.prototype.toString=function(){return"ATR ("+this.options.period+")"},BOP=function(a,b,c){IndicatorBase.call(this,a,b,c);for(var d=0;d<a.length;d++){var e=a[d].close,f=a[d].open,g=a[d].high,h=a[d].low,i=0;g-h!==0&&(i=(e-f)/(g-h)),this.indicatorData.push({time:a[d].time,value:toFixed(i,4)})}},BOP.prototype=Object.create(IndicatorBase.prototype),BOP.prototype.constructor=BOP,BOP.prototype.addPoint=function(a){var b=a.close,c=a.open,d=a.high,e=a.low,f=0;return d-e!==0&&(f=(b-c)/(d-e)),this.indicatorData.push({time:a.time,value:f}),[{id:this.uniqueID,value:f}]},BOP.prototype.update=function(a){var b=a.close,c=a.open,d=a.high,e=a.low,f=0;return d-e!==0&&(f=(b-c)/(d-e)),this.indicatorData[this.indicatorData.length-1].value=f,[{id:this.uniqueID,value:f}]},BOP.prototype.toString=function(){return" BOP"},BOP.prototype.buildSeriesAndAxisConfFromData=function(a){var b=IndicatorBase.prototype.buildSeriesAndAxisConfFromData.call(this,a);return b.forEach(function(a){a.seriesConf.type="column"}),b},NATR=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.atr=new window.ATR(a,b,c);for(var d=0;d<a.length;d++){if(d>=this.options.period-1){var e=c.getIndicatorOrPriceValue(a[d],this.options.appliedTo),f=toFixed(this.atr.indicatorData[d].value/e*100,4);this.indicatorData.push({time:a[d].time,value:f})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},NATR.prototype=Object.create(IndicatorBase.prototype),NATR.prototype.constructor=NATR,NATR.prototype.addPoint=function(a){this.priceData.push(a);var b=(this.priceData.length-1,this.atr.addPoint(a)[0].value),c=this.indicators.getIndicatorOrPriceValue(a,this.options.appliedTo),d=toFixed(b/c*100,4);return this.indicatorData.push({time:a.time,value:d}),[{id:this.uniqueID,value:d}]},NATR.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.atr.update(a)[0].value,d=this.indicators.getIndicatorOrPriceValue(a,this.options.appliedTo),e=toFixed(c/d*100,4);return this.indicatorData[b].value=e,[{id:this.uniqueID,value:e}]},NATR.prototype.toString=function(){return"NATR ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},ROCP=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[];for(var d=0;d<a.length;d++){if(d>=this.options.period){var e=this.indicators.getIndicatorOrPriceValue(a[d],this.options.appliedTo),f=this.indicators.getIndicatorOrPriceValue(a[d-this.options.period],this.options.appliedTo),g=toFixed((e-f)/f,4);this.indicatorData.push({time:a[d].time,value:g})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},ROCP.prototype=Object.create(IndicatorBase.prototype),ROCP.prototype.constructor=ROCP,ROCP.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1,c=this.indicators.getIndicatorOrPriceValue(this.priceData[b],this.options.appliedTo),d=this.indicators.getIndicatorOrPriceValue(this.priceData[b-this.options.period],this.options.appliedTo),e=toFixed((c-d)/d,4);return this.indicatorData.push({time:a.time,value:e}),[{id:this.uniqueID,value:e}]},ROCP.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.indicators.getIndicatorOrPriceValue(this.priceData[b],this.options.appliedTo),d=this.indicators.getIndicatorOrPriceValue(this.priceData[b-this.options.period],this.options.appliedTo),e=toFixed((c-d)/d,4);return this.indicatorData[b].value=e,[{id:this.uniqueID,value:e}]},ROCP.prototype.toString=function(){return"ROCP ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},ROCR=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[];for(var d=0;d<a.length;d++){if(d>=this.options.period){var e=this.indicators.getIndicatorOrPriceValue(a[d],this.options.appliedTo),f=this.indicators.getIndicatorOrPriceValue(a[d-this.options.period],this.options.appliedTo),g=toFixed(e/f,4);this.indicatorData.push({time:a[d].time,value:g})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},ROCR.prototype=Object.create(IndicatorBase.prototype),ROCR.prototype.constructor=ROCR,ROCR.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1,c=this.indicators.getIndicatorOrPriceValue(this.priceData[b],this.options.appliedTo),d=this.indicators.getIndicatorOrPriceValue(this.priceData[b-this.options.period],this.options.appliedTo),e=toFixed(c/d,4);return this.indicatorData.push({time:a.time,value:e}),[{id:this.uniqueID,value:e}]},ROCR.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.indicators.getIndicatorOrPriceValue(this.priceData[b],this.options.appliedTo),d=this.indicators.getIndicatorOrPriceValue(this.priceData[b-this.options.period],this.options.appliedTo),e=toFixed(c/d,4);return this.indicatorData[b].value=e,[{id:this.uniqueID,value:e}]},ROCR.prototype.toString=function(){return"ROCR ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},WILLR=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.calculateWILLRValue=function(a,b){for(var c=a[b].high,d=a[b].close,e=0;e<this.options.period;e++)c=Math.max(c,a[b-e].high),d=Math.min(d,a[b-e].low);var f=this.indicators.getIndicatorOrPriceValue(a[b],this.options.appliedTo),g=-100*(c-f)/(c-d);return toFixed(g,4)};for(var d=0;d<a.length;d++){if(d>=this.options.period){var e=this.calculateWILLRValue(a,d);this.indicatorData.push({time:a[d].time,value:e})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},WILLR.prototype=Object.create(IndicatorBase.prototype),WILLR.prototype.constructor=WILLR,WILLR.prototype.addPoint=function(a){this.priceData.push(a);var b=this.calculateWILLRValue(this.priceData,this.priceData.length-1);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},WILLR.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.calculateWILLRValue(this.priceData,b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},WILLR.prototype.toString=function(){return"WILLR ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},ADX=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.atr=new ATR(a,b,c),this.calculateDMValue=function(a,b){var c=a[b].high-a[b-1].high,d=a[b].low-a[b-1].low,e=0,f=0;return c>d&&c>0&&(e=c),d>c&&d>0&&(f=d),{plusDm:e,minusDM:f}},this.calculateDMData=function(a){for(var b=[{time:a[0].time,close:0}],c=[{time:a[0].time,close:0}],d=1;d<a.length;d++){var e=this.calculateDMValue(a,d);0===this.atr.indicatorData[d].value?(b.push({time:a[0].time,close:0}),c.push({time:a[0].time,close:0})):(b.push({time:a[d].time,close:e.plusDm/this.atr.indicatorData[d].value}),c.push({time:a[d].time,close:e.minusDM/this.atr.indicatorData[d].value}))}return{plusDMData:b,minusDMData:c}};var d=this.calculateDMData(a);this.PlusDI=new window[this.options.maType](d.plusDMData,{maType:this.options.maType,period:this.options.period},c),this.MinusDI=new window[this.options.maType](d.minusDMData,{maType:this.options.maType,period:this.options.period},c);var e=[],f=0,g=this;this.PlusDI.indicatorData.forEach(function(b){var c=g.MinusDI.indicatorData[f];e.push(b.value+c.value===0?{time:b.time,close:0}:{time:b.time,close:Math.abs((b.value-c.value)/(b.value+c.value))}),g.priceData.push(a[f]),f++}),this.adxdata=new window[this.options.maType](e,{maType:this.options.maType,period:this.options.period},c),this.indicatorData=this.adxdata.indicatorData},ADX.prototype=Object.create(IndicatorBase.prototype),ADX.prototype.constructor=ADX,ADX.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1,c=this.atr.addPoint(a)[0].value,d=this.calculateDMValue(this.priceData,b),e=this.PlusDI.addPoint({time:a.time,close:0===c?0:d.plusDm/c})[0].value,f=this.MinusDI.addPoint({time:a.time,close:0===c?0:d.minusDM/c})[0].value,g=e+f===0?0:Math.abs((e-f)/(e+f)),h=this.adxdata.addPoint({time:a.time,close:g})[0].value;return this.indicatorData=this.adxdata.indicatorData,[{id:this.uniqueID,value:h}]},ADX.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.atr.update(a)[0].value,d=this.calculateDMValue(this.priceData,b),e=this.PlusDI.update({time:a.time,close:0===c?0:d.plusDm/c})[0].value,f=this.MinusDI.update({time:a.time,close:0===c?0:d.minusDM/c})[0].value,g=e+f===0?0:Math.abs((e-f)/(e+f)),h=this.adxdata.update({time:a.time,close:g})[0].value;return this.indicatorData=this.adxdata.indicatorData,[{id:this.uniqueID,value:h}]},ADX.prototype.toString=function(){return"ADX ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},ADXR=function(a,b,c){IndicatorBase.call(this,a,b,c),this.adx=new ADX(a,b,c);for(var d=0;d<a.length;d++)if(d>=this.options.period){var e=(this.adx.indicatorData[d].value+this.adx.indicatorData[d-this.options.period].value)/2;this.indicatorData.push({time:a[d].time,value:toFixed(e,4)})}else this.indicatorData.push({time:a[d].time,value:0})},ADXR.prototype=Object.create(IndicatorBase.prototype),ADXR.prototype.constructor=ADXR,ADXR.prototype.addPoint=function(a){var b=this.adx.addPoint(a)[0].value,c=this.adx.indicatorData.length-1,d=(b+this.adx.indicatorData[c-this.options.period].value)/2;return this.indicatorData.push({time:a.time,value:toFixed(d,4)}),[{id:this.uniqueID,value:d}]},ADXR.prototype.update=function(a){var b=this.adx.update(a)[0].value,c=this.adx.indicatorData.length-1,d=(b+this.adx.indicatorData[c-this.options.period].value)/2;return this.indicatorData[c].value=toFixed(d,4),[{id:this.uniqueID,value:d}]},ADXR.prototype.toString=function(){return"ADXR ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},ALMA=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.CalculateALMAValue=function(a,b){for(var c=Math.floor(this.options.offset*(this.options.period-1)),d=this.options.period/this.options.sigma,e=0,f=0,g=0;g<this.options.period;g++){var h=Math.exp(-(Math.pow(g-c,2)/(2*Math.pow(d,2))));e+=this.indicators.getIndicatorOrPriceValue(a[b-g],this.options.appliedTo)*h,f+=h}var i=0;return 0!==f&&(i=e/f),toFixed(i,4)};for(var d=0;d<a.length;d++){if(d>=this.options.period){var e=this.CalculateALMAValue(a,d);this.indicatorData.push({time:a[d].time,value:e})}else this.indicatorData.push({time:a[d].time,value:null});this.priceData.push(a[d])}},ALMA.prototype=Object.create(IndicatorBase.prototype),ALMA.prototype.constructor=ALMA,ALMA.prototype.addPoint=function(a){this.priceData.push(a);var b=this.CalculateALMAValue(this.priceData,this.priceData.length-1);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},ALMA.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.CalculateALMAValue(this.priceData,b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},ALMA.prototype.toString=function(){return"ALMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},AO=function(a,b,c){b.shortMaType=(b.shortMaType||"SMA").toUpperCase(),b.longMaType=(b.longMaType||"SMA").toUpperCase(),IndicatorBase.call(this,a,b,c);var d={maType:b.shortMaType,period:b.shortPeriod},e={maType:b.longMaType,period:b.longPeriod};this.getBarColor=function(a){var b=this.options.aoHighStroke;return a>1&&this.indicatorData[a].value<this.indicatorData[a-1].value&&(b=this.options.aoLowStroke),b};for(var f=[],g=0;g<a.length;g++){var h=(a[g].high+a[g].low)/2;f.push({time:a[g].time,close:h})}this.shortMa=new window[b.shortMaType](f,d,c),this.longMa=new window[b.longMaType](f,e,c);var g=0,i=this;this.shortMa.indicatorData.forEach(function(b){var c=toFixed(b.value-i.longMa.indicatorData[g].value,4);i.indicatorData.push({time:a[g].time,value:c}),g++})},AO.prototype=Object.create(IndicatorBase.prototype),AO.prototype.constructor=AO,AO.prototype.addPoint=function(a){var b=(a.high+a.low)/2,c=this.shortMa.addPoint({time:a.time,close:b})[0].value,d=this.longMa.addPoint({time:a.time,close:b})[0].value,e=toFixed(c-d,4);return this.indicatorData.push({time:a.time,value:e}),[{id:this.uniqueID,value:e,color:this.getBarColor(this.indicatorData.length-1)}]},AO.prototype.update=function(a){var b=this.indicatorData.length-1,c=(a.high+a.low)/2,d=this.shortMa.update({time:a.time,close:c})[0].value,e=this.longMa.update({time:a.time,close:c})[0].value,f=toFixed(d-e,4);return this.indicatorData[b].value=f,[{id:this.uniqueID,value:f}]},AO.prototype.toString=function(){return"AO ("+this.options.shortPeriod+", "+this.options.longPeriod+")"},AO.prototype.buildSeriesAndAxisConfFromData=function(a){for(var b=[],c=[],d=0;d<this.indicatorData.length;d++){var e=this.indicatorData[d];b.push([e.time,e.value]),c.push(this.getBarColor(d))}return[{axisConf:{id:a.id+"-"+this.uniqueID,title:{text:this.toString(),align:"high",offset:0,rotation:0,y:10,x:30+7.5*this.toString().length},lineWidth:2,plotLines:this.options.levels}},{seriesConf:{id:this.uniqueID,name:this.toString(),data:b,type:"column",yAxis:a.id+"-"+this.uniqueID,onChartIndicator:!1,colorByPoint:!0,colors:c}}]},APO=function(a,b,c){b.fastMaType=(b.fastMaType||"SMA").toUpperCase(),b.slowMaType=(b.slowMaType||"SMA").toUpperCase(),IndicatorBase.call(this,a,b,c);var d={maType:b.slowMaType,period:b.slowPeriod,appliedTo:b.appliedTo},e={maType:b.fastMaType,period:b.fastPeriod,appliedTo:b.appliedTo};this.fastMa=new window[b.fastMaType](a,e,c),this.slowMa=new window[b.slowMaType](a,d,c);for(var f=0;f<a.length;f++)if(f>=this.options.slowPeriod){var g=toFixed(this.fastMa.indicatorData[f].value-this.slowMa.indicatorData[f].value,4);this.indicatorData.push({time:a[f].time,value:g})}else this.indicatorData.push({time:a[f].time,value:0})},APO.prototype=Object.create(IndicatorBase.prototype),APO.prototype.constructor=APO,APO.prototype.addPoint=function(a){var b=this.fastMa.addPoint(a)[0].value,c=this.slowMa.addPoint(a)[0].value,d=toFixed(b-c,4);return this.indicatorData.push({time:a.time,value:d}),[{id:this.uniqueID,value:d}]},APO.prototype.update=function(a){var b=this.indicatorData.length-1,c=this.fastMa.update(a)[0].value,d=this.slowMa.update(a)[0].value,e=toFixed(c-d,4);return this.indicatorData[b].value=e,[{id:this.uniqueID,value:e}]},APO.prototype.toString=function(){return"APO ("+this.options.fastPeriod+", "+this.options.slowPeriod+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},AROON=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.aroonDownData=[],this.uniqueID=[uuid(),uuid()],this.CalculateAROONValue=function(a,b){for(var c=a[b].high,d=a[b].low,e=0,f=0,g=0;g<this.options.period;g++)a[b-g].high>c&&(c=a[b-g].high,e=g),a[b-g].low<d&&(d=a[b-g].low,f=g);var h=(this.options.period-e)/this.options.period*100,i=(this.options.period-f)/this.options.period*100;return{aroonUp:h,aroonDown:i}};for(var d=0;d<a.length;d++){if(d>=this.options.period-1){var e=this.CalculateAROONValue(a,d);this.indicatorData.push({time:a[d].time,value:e.aroonUp}),this.aroonDownData.push({time:a[d].time,value:e.aroonDown})}else this.indicatorData.push({time:a[d].time,value:0}),this.aroonDownData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},AROON.prototype=Object.create(IndicatorBase.prototype),AROON.prototype.constructor=AROON,AROON.prototype.addPoint=function(a){this.priceData.push(a);var b=this.CalculateAROONValue(this.priceData,this.priceData.length-1);return this.indicatorData.push({time:a.time,value:b.aroonUp}),this.aroonDownData.push({time:a.time,value:b.aroonDown}),[{id:this.uniqueID[0],value:b.aroonUp},{id:this.uniqueID[1],value:b.aroonDown}]},AROON.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.CalculateAROONValue(this.priceData,b);return this.indicatorData[b].value=c.aroonUp,this.aroonDownData[b].value=c.aroonDown,[{id:this.uniqueID[0],value:c.aroonUp},{id:this.uniqueID[1],value:c.aroonDown}]},AROON.prototype.toString=function(){return"AROON ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},AROON.prototype.buildSeriesAndAxisConfFromData=function(a){var b=[];this.indicatorData.forEach(function(a){b.push([a.time,a.value])});var c=[];return this.aroonDownData.forEach(function(a){c.push([a.time,a.value])}),[{axisConf:{id:a.id+"-"+this.uniqueID[0],title:{text:this.toString(),align:"high",offset:0,rotation:0,y:10,x:30+7.5*this.toString().length},lineWidth:2,plotLines:this.options.levels}},{seriesConf:{id:this.uniqueID[0],name:"AROONUP - "+this.toString(),data:b,type:"line",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.aroonUpStroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}},{seriesConf:{id:this.uniqueID[1],name:"AROONDOWN - "+this.toString(),data:c,type:"line",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.aroonDownStroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}}]},AROON.prototype.getIDs=function(){return this.uniqueID},AROON.prototype.isSameInstance=function(a){return _.isEqual(a.sort(),this.uniqueID)},AROONOSC=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.CalculateAROONOSCValue=function(a,b){for(var c=a[b].high,d=a[b].low,e=0,f=0,g=0;g<this.options.period;g++)a[b-g].high>c&&(c=a[b-g].high,e=g),a[b-g].low<d&&(d=a[b-g].low,f=g);var h=(this.options.period-e)/this.options.period*100,i=(this.options.period-f)/this.options.period*100;return h-i};for(var d=0;d<a.length;d++){if(d>=this.options.period-1){var e=this.CalculateAROONOSCValue(a,d);this.indicatorData.push({time:a[d].time,value:e})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},AROONOSC.prototype=Object.create(IndicatorBase.prototype),AROONOSC.prototype.constructor=AROONOSC,AROONOSC.prototype.addPoint=function(a){this.priceData.push(a);var b=this.CalculateAROONOSCValue(this.priceData,this.priceData.length-1);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},AROONOSC.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.CalculateAROONOSCValue(this.priceData,b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},AROONOSC.prototype.toString=function(){return"AROONOSC ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},BBANDS=function(a,b,c){b.maType=(b.maType||"SMA").toUpperCase(),IndicatorBase.call(this,a,b,c),this.ma=new window[b.maType](a,b,c),this.stddev=new STDDEV(a,b,c),this.indicatorData=this.ma.indicatorData,this.upperBandData=[],this.lowerBandData=[],this.areaRangeData=[],this.uniqueID=[uuid(),uuid(),uuid(),uuid()];for(var d=0;d<a.length;d++){var e=toFixed(this.ma.indicatorData[d].value+this.stddev.indicatorData[d].value*b.devUp,4),f=toFixed(this.ma.indicatorData[d].value-this.stddev.indicatorData[d].value*b.devDn,4);this.upperBandData.push({time:a[d].time,value:e}),this.lowerBandData.push({time:a[d].time,value:f}),this.areaRangeData.push({time:a[d].time,value:[e,f]})}},BBANDS.prototype=Object.create(IndicatorBase.prototype),
BBANDS.prototype.constructor=BBANDS,BBANDS.prototype.addPoint=function(a){var b=this.ma.addPoint(a)[0].value,c=this.stddev.addPoint(a)[0].value,d=toFixed(b+c*this.options.devUp,4),e=toFixed(b-c*this.options.devDn,4);return this.indicatorData=this.ma.indicatorData,this.upperBandData.push({time:a.time,value:d}),this.lowerBandData.push({time:a.time,value:e}),this.areaRangeData.push({time:a.time,value:[d,e]}),[{id:this.uniqueID[0],value:b},{id:this.uniqueID[1],value:d},{id:this.uniqueID[2],value:e},{id:this.uniqueID[3],value:[d,e]}]},BBANDS.prototype.update=function(a){var b=this.indicatorData.length-1,c=this.ma.update(a)[0].value,d=this.stddev.update(a)[0].value,e=toFixed(c+d*this.options.devUp,4),f=toFixed(c-d*this.options.devDn,4);return this.indicatorData=this.ma.indicatorData,this.upperBandData[b].value=e,this.lowerBandData[b].value=f,this.areaRangeData[b].value=[e,f],[{id:this.uniqueID[0],value:c},{id:this.uniqueID[1],value:e},{id:this.uniqueID[2],value:f},{id:this.uniqueID[3],value:[e,f]}]},BBANDS.prototype.toString=function(){return"BBANDS ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+", "+this.options.devUp+", "+this.options.devDn+")"},BBANDS.prototype.buildSeriesAndAxisConfFromData=function(){var a=[];this.indicatorData.forEach(function(b){a.push([b.time,b.value])});var b=[];this.upperBandData.forEach(function(a){b.push([a.time,a.value])});var c=[];this.lowerBandData.forEach(function(a){c.push([a.time,a.value])});var d=[];return this.areaRangeData.forEach(function(a){d.push(_.flattenDeep([a.time,a.value]))}),[{seriesConf:{id:this.uniqueID[0],name:"Middle - "+this.toString(),data:a,type:"line",color:this.options.stroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!0}},{seriesConf:{id:this.uniqueID[1],name:"Upper - "+this.toString(),data:b,type:"line",color:this.options.stroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!0}},{seriesConf:{id:this.uniqueID[2],name:"Lower - "+this.toString(),data:c,type:"line",color:this.options.stroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!0}},{seriesConf:{id:this.uniqueID[3],data:d,name:"BBANDS Range",type:"arearange",color:"white",fillColor:this.options.backgroundColor,connectNulls:!0,states:{hover:{enabled:!1}},events:{},dataLabels:{enabled:!1},point:{events:{}},enableMouseTracking:!1,onChartIndicator:!0}}]},BBANDS.prototype.getIDs=function(){return this.uniqueID},BBANDS.prototype.isSameInstance=function(a){return _.isEqual(a.sort(),this.uniqueID)},CC=function(a,b,c){IndicatorBase.call(this,a,b,c),this.shortRoc=new ROC(a,{period:b.shortRocPeriod,appliedTo:b.appliedTo},c),this.longRoc=new ROC(a,{period:b.longRocPeriod,appliedTo:b.appliedTo},c),rocData=[];for(var d=0;d<a.length;d++)rocData.push({time:a[d].time,close:this.shortRoc.indicatorData[d].value+this.longRoc.indicatorData[d].value});this.wmaData=new WMA(rocData,{period:b.wmaPeriod},c),this.indicatorData=this.wmaData.indicatorData},CC.prototype=Object.create(IndicatorBase.prototype),CC.prototype.constructor=CC,CC.prototype.addPoint=function(a){var b=this.shortRoc.addPoint(a)[0].value,c=this.longRoc.addPoint(a)[0].value,d=this.wmaData.addPoint({time:a.time,close:b+c})[0].value;return this.indicatorData=this.wmaData.indicatorData,[{id:this.uniqueID,value:d}]},CC.prototype.update=function(a){var b=this.shortRoc.update(a)[0].value,c=this.longRoc.update(a)[0].value,d=this.wmaData.update({time:a.time,close:b+c})[0].value;return this.indicatorData=this.wmaData.indicatorData,[{id:this.uniqueID,value:d}]},CC.prototype.toString=function(){return"CC ("+this.options.shortRocPeriod+", "+this.options.longRocPeriod+", "+this.options.wmaPeriod+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},CCI=function(a,b,c){b.maType=(b.maType||"SMA").toUpperCase(),IndicatorBase.call(this,a,b,c),this.tpData=[],this.priceData=[],this.CalculateCCIValue=function(a,b){for(var c=0,d=0;d<this.options.period-1;d++)c+=Math.abs(this.tpMa.indicatorData[b].value-this.tpData[b-d].close);var e=c/this.options.period,f=toFixed((this.tpData[b].close-this.tpMa.indicatorData[b].value)/(.015*e),4);return f};for(var d=0;d<a.length;d++){var e=(a[d].high+a[d].low+a[d].close)/3;this.tpData.push({time:a[d].time,close:e})}b.appliedTo=this.indicators.CLOSE,this.tpMa=new window[this.options.maType](this.tpData,b,c);for(var d=0;d<a.length;d++){if(d>=this.options.period-1){var f=this.CalculateCCIValue(a,d,!1);this.indicatorData.push({time:a[d].time,value:f})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},CCI.prototype=Object.create(IndicatorBase.prototype),CCI.prototype.constructor=CCI,CCI.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1,c=(this.priceData[b].high+this.priceData[b].low+this.priceData[b].close)/3;this.tpData.push({time:a.time,close:c}),this.tpMa.addPoint(this.tpData[b]);var d=this.CalculateCCIValue(this.priceData,this.priceData.length-1,!1);return this.indicatorData.push({time:a.time,value:d}),[{id:this.uniqueID,value:d}]},CCI.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=(this.priceData[b].high+this.priceData[b].low+this.priceData[b].close)/3;this.tpData[b].close=c,this.tpMa.update(this.tpData[b]);var d=this.CalculateCCIValue(this.priceData,b,!1);return this.indicatorData[b].value=d,[{id:this.uniqueID,value:d}]},CCI.prototype.toString=function(){return"CCI ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},CDL=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.priceData.push(a[0]),this.priceData.push(a[1]);for(var d=2;d<a.length;d++){this.priceData.push(a[d]);var e=this.calculateIndicatorValue(this.options.cdlIndicatorCode);e&&this.indicatorData.push(e)}},CDL.prototype=Object.create(IndicatorBase.prototype),CDL.prototype.constructor=CDL,CDL.prototype.addPoint=function(a){this.priceData.push(a);var b=this.calculateIndicatorValue(this.options.cdlIndicatorCode)||{};return b.text&&this.indicatorData.push(b),[{id:this.uniqueID,value:new CDLUpdateObject(b.x||a.time,b.title,b.text)}]},CDL.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.calculateIndicatorValue(this.options.cdlIndicatorCode)||{};return c.text&&(this.indicatorData[b]=c),[{id:this.uniqueID,value:new CDLUpdateObject(c.x||a.time,c.title,c.text)}]},CDL.prototype.toString=function(){return this.indicators.getIndicatorsJSONData()[this.options.cdlIndicatorCode].long_display_name},CDL.prototype.buildSeriesAndAxisConfFromData=function(){return[{seriesConf:{id:this.uniqueID,name:this.toString(),data:this.indicatorData,type:"flags",dashStyle:this.options.dashStyle,onChartIndicator:!0,onSeries:this.options.onSeriesID,shape:"flag",turboThreshold:0}}]},CDLUpdateObject=function(a,b,c){this.x=a,this.title=b,this.text=c,this.toJSObject=function(){return{x:a,title:b,text:c}}},CDL.prototype.CDL2CROWS=function(){var a=CDLGETPARAMS(this.priceData),b=a.isCandleThree_Bullish&&a.isCandleTwo_Bearish&&a.candleTwo_Open>a.candleThree_Close&&a.candleTwo_Close>a.candleThree_Close&&a.isCandleOne_Bearish&&a.candleOne_Open<a.candleTwo_Open&&a.candleOne_Open>a.candleTwo_Close&&a.candleOne_Close<a.candleThree_Close&&a.candleOne_Close>a.candleThree_Open,c=a.isCandleThree_Bearish&&a.isCandleTwo_Bullish&&a.candleTwo_Open<a.candleThree_Close&&a.candleTwo_Close<a.candleThree_Close&&a.isCandleOne_Bullish&&a.candleOne_Open>a.candleTwo_Open&&a.candleOne_Open<a.candleTwo_Close&&a.candleOne_Close>a.candleThree_Close&&a.candleOne_Close<a.candleThree_Open;return{isBear:b,isBull:c}},CDL.prototype.CDLDOJI=function(a,b,c,d){var e=a===d,f=Math.abs(a-b),g=Math.abs(a-c),h=Math.abs(c-b),i=Math.abs(a-d),j=(e||.05*h>=i)&&g>f,k=(e||.05*h>=i)&&f>g,l=(e||.05*h>=i)&&f>i&&g>i;return{isBull:k,isBear:j,isDoji:l}},CDL.prototype.CDL3BLACKCROWS=function(){var a=CDLGETPARAMS(this.priceData),b=!1;a.candleFour_Index>=0&&(b=a.isCandleThree_Bearish&&a.isCandleTwo_Bearish&&a.isCandleOne_Bearish&&a.candleThree_Close<a.candleFour_Low&&a.candleTwo_Close<a.candleThree_Low&&a.candleOne_Close<a.candleTwo_Low&&_.inRange(a.candleThree_Open,a.candleFour_Close,a.candleFour_Open)&&_.inRange(a.candleTwo_Open,a.candleThree_Close,a.candleThree_Open)&&_.inRange(a.candleOne_Open,a.candleTwo_Close,a.candleTwo_Open));var c=!1;return{isBull:c,isBear:b}},CDL.prototype.CDL3INSIDE=function(){var a=CDLGETPARAMS(this.priceData),b=a.isCandleThree_Bullish&&a.isCandleTwo_Bearish&&_.inRange(a.candleTwo_Open,a.candleThree_Open,a.candleThree_Close)&&_.inRange(a.candleTwo_Close,a.candleThree_Open,a.candleThree_Close)&&a.isCandleOne_Bearish&&a.candleOne_Close<a.candleTwo_Close,c=a.isCandleThree_Bearish&&a.isCandleTwo_Bullish&&_.inRange(a.candleTwo_Open,a.candleThree_Close,a.candleThree_Open)&&_.inRange(a.candleTwo_Close,a.candleThree_Close,a.candleThree_Open)&&a.isCandleOne_Bullish&&a.candleOne_Close>a.candleTwo_Close;return{isBear:b,isBull:c}},CDL.prototype.CDL3LINESTRIKE=function(){var a=CDLGETPARAMS(this.priceData),b=!1,c=!1;return a.candleFour_Index>=0&&(b=a.isCandleFour_Bearish&&a.isCandleThree_Bearish&&a.candleThree_Close<a.candleFour_Close&&a.isCandleTwo_Bearish&&a.candleTwo_Close<a.candleThree_Close&&a.isCandleOne_Bullish&&a.candleOne_Close>a.candleFour_Open&&a.candleOne_Open<a.candleTwo_Close,c=a.isCandleFour_Bullish&&a.isCandleThree_Bullish&&a.candleThree_Close>a.candleFour_Close&&a.isCandleTwo_Bullish&&a.candleTwo_Close>a.candleThree_Close&&a.isCandleOne_Bearish&&a.candleOne_Close<a.candleFour_Open&&a.candleOne_Open<a.candleTwo_Close),{isBear:c,isBull:b}},CDL.prototype.CDL3OUTSIDE=function(){var a=CDLGETPARAMS(this.priceData),b=a.isCandleThree_Bullish&&a.isCandleTwo_Bearish&&a.candleTwo_Open>a.candleThree_Close&&a.candleTwo_Close<a.candleThree_Open&&a.isCandleOne_Bearish,c=a.isCandleThree_Bearish&&a.isCandleTwo_Bullish&&a.candleTwo_Open<a.candleThree_Close&&a.candleTwo_Close>a.candleThree_Open&&a.isCandleOne_Bullish;return{isBear:b,isBull:c}},CDL.prototype.CDL3STARSSOUTH=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(a.candleThree_Close-a.candleThree_Open),c=Math.abs(a.candleTwo_Close-a.candleTwo_Open),d=Math.abs(a.candleOne_Close-a.candleOne_Open),e=Math.abs(a.candleThree_Low-Math.min(a.candleThree_Close,a.candleThree_Open)),f=this.CDLMARUBOZU(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close),g=a.isCandleThree_Bearish&&e>=b&&a.isCandleTwo_Bearish&&a.candleTwo_Low>a.candleThree_Low&&a.candleTwo_Open<a.candleThree_Open&&b>c&&f.isBear&&a.candleOne_Low>a.candleTwo_Low&&c>d,h=!1;return{isBear:h,isBull:g}},CDL.prototype.CDLABANDONEDBABY=function(){var a=CDLGETPARAMS(this.priceData),b=this.CDLDOJI(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close),c=a.isCandleThree_Bullish&&b.isDoji&&a.candleTwo_Low>a.candleThree_High&&a.isCandleOne_Bearish&&a.candleTwo_Low>a.candleOne_High,d=a.isCandleThree_Bearish&&b.isDoji&&a.candleTwo_High<a.candleThree_Low&&a.isCandleOne_Bullish&&a.candleTwo_High<a.candleOne_Low;return{isBear:c,isBull:d}},CDL.prototype.CDLADVANCEBLOCK=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(a.candleOne_Open-a.candleOne_Close),c=Math.abs(a.candleThree_Open-a.candleThree_Close),d=Math.abs(a.candleTwo_Open-a.candleTwo_Close),e=Math.abs(a.candleThree_High-a.candleThree_Close),f=Math.abs(a.candleTwo_High-a.candleTwo_Close),g=Math.abs(a.candleOne_High-a.candleOne_Close),h=!1,i=a.isCandleThree_Bullish&&this.indicators.isLongCandle(a.candleThree_Open,a.candleThree_High,a.candleThree_Low,a.candleThree_Close)&&a.isCandleTwo_Bullish&&c>=d&&a.candleTwo_Close>a.candleThree_Close&&a.candleTwo_Open<=a.candleThree_Close&&a.candleTwo_Open>a.candleThree_Open&&a.isCandleOne_Bullish&&d>=b&&a.candleOne_Close>a.candleTwo_Close&&a.candleOne_Open<=a.candleTwo_Close&&a.candleOne_Open>a.candleTwo_Open&&f>e&&g>e;return{isBear:i,isBull:h}},CDL.prototype.CDLBELTHOLD=function(){var a=CDLGETPARAMS(this.priceData),b=a.isCandleThree_Bearish&&a.isCandleTwo_Bearish&&a.isCandleOne_Bullish&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&a.candleOne_Open===a.candleOne_Low&&a.candleOne_Open<a.candleTwo_Close,c=a.isCandleThree_Bullish&&a.isCandleTwo_Bullish&&a.isCandleOne_Bearish&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&a.candleOne_Open===a.candleOne_High&&a.candleOne_Open>a.candleTwo_Close;return{isBear:c,isBull:b}},CDL.prototype.CDLBREAKAWAY=function(){var a=CDLGETPARAMS(this.priceData),b=!1,c=!1;if(a.candleFour_Index>=0&&a.candleFive_Index>0)var d=Math.abs(a.candleFive_Close-a.candleFive_Open),e=d/2,b=a.isCandleFive_Bearish&&this.indicators.isLongCandle(a.candleFive_Open,a.candleFive_High,a.candleFive_Low,a.candleFive_Close)&&a.isCandleFour_Bearish&&Math.abs(a.candleFour_Close-a.candleFour_Open)<e&&a.candleFour_Open<a.candleFive_Close&&Math.abs(a.candleThree_Close-a.candleThree_Open)<e&&Math.min(a.candleThree_Close,a.candleThree_Open)<a.candleFour_Close&&Math.abs(a.candleTwo_Close-a.candleTwo_Open)<e&&Math.min(a.candleTwo_Close,a.candleTwo_Open)<Math.min(a.candleThree_Close,a.candleThree_Open)&&a.isCandleOne_Bullish&&a.candleOne_Open>Math.min(a.candleTwo_Close,a.candleTwo_Open)&&a.candleOne_Close>a.candleFour_Open&&a.candleOne_Close<a.candleFive_Open,c=a.isCandleFive_Bullish&&a.isCandleFour_Bullish&&Math.abs(a.candleFour_Close-a.candleFour_Open)<a.shortCandleSize&&a.candleFour_Open>a.candleFive_Close&&Math.abs(a.candleThree_Close-a.candleThree_Open)<e&&Math.max(a.candleThree_Close,a.candleThree_Open)>a.candleFour_Close&&Math.abs(a.candleTwo_Close-a.candleTwo_Open)<e&&Math.max(a.candleTwo_Close,a.candleTwo_Open)>Math.max(a.candleThree_Close,a.candleThree_Open)&&a.isCandleOne_Bearish&&a.candleOne_Open<Math.max(a.candleTwo_Close,a.candleTwo_Open)&&a.candleOne_Close<a.candleFour_Open&&a.candleOne_Close>a.candleFive_Close;return{isBull:b,isBear:c}},CDL.prototype.CDLCLOSINGMARUBOZU=function(){var a=CDLGETPARAMS(this.priceData),b=a.isCandleOne_Bearish&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&a.candleOne_Low===a.candleOne_Close,c=a.isCandleOne_Bullish&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&a.candleOne_High===a.candleOne_Close;return{isBear:b,isBull:c}},CDL.prototype.CDLCOUNTERATTACK=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(a.candleTwo_Close-a.candleTwo_Open),c=a.isCandleTwo_Bearish&&a.isCandleOne_Bullish&&a.candleOne_Close<=a.candleTwo_Close+.05*b&&a.candleOne_Close>=a.candleTwo_Close-.05*b,d=a.isCandleTwo_Bullish&&a.isCandleOne_Bearish&&a.candleOne_Close<=a.candleTwo_Close+.05*b&&a.candleOne_Close>=a.candleTwo_Close-.05*b;return{isBear:d,isBull:c}},CDL.prototype.CDLDARKCLOUDCOVER=function(){var a=CDLGETPARAMS(this.priceData),b=!1,c=a.isCandleTwo_Bullish&&a.isCandleOne_Bearish&&a.candleOne_Open>a.candleTwo_Close&&a.candleOne_Close<a.candleTwo_Open+Math.abs(a.candleTwo_Open-a.candleTwo_Close)/2&&a.candleOne_Close>a.candleTwo_Open;return{isBear:c,isBull:b}},CDL.prototype.CDLDOJISTAR=function(){var a=CDLGETPARAMS(this.priceData),b=this.CDLDOJI(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close),c=a.isCandleTwo_Bullish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&b.isBear&&a.candleOne_Close>=a.candleTwo_Close,d=a.isCandleTwo_Bearish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&b.isBull&&a.candleOne_Close<=a.candleTwo_Close;return{isBear:c,isBull:d}},CDL.prototype.CDL3WHITESOLDIERS=function(){var a=CDLGETPARAMS(this.priceData),b=!1,c=!1;return a.candleFour_Index>=0&&(b=a.isCandleThree_Bullish&&a.candleThree_Close>=a.candleFour_Close&&this.indicators.isLongCandle(a.candleThree_Open,a.candleThree_High,a.candleThree_Low,a.candleThree_Close)&&a.isCandleTwo_Bullish&&a.candleTwo_Open>=a.candleThree_Open&&a.candleTwo_Open<=a.candleThree_Close&&a.candleTwo_Close>=a.candleThree_Close&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.isCandleOne_Bullish&&a.candleOne_Open>=a.candleTwo_Open&&a.candleOne_Open<=a.candleTwo_Close&&a.candleOne_Close>=a.candleTwo_Close&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close),c=!1),{isBear:c,isBull:b}},CDL.prototype.CDLDRAGONFLYDOJI=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(a.candleOne_Low-Math.min(a.candleOne_Open,a.candleOne_Close)),c=Math.abs(a.candleOne_High-Math.max(a.candleOne_Open,a.candleOne_Close)),d=Math.abs(a.candleOne_Low-a.candleOne_High),e=Math.abs(a.candleOne_Open-a.candleOne_Close),f=(a.candleOne_Open===a.candleOne_Close||.1*d>e)&&(a.candleOne_High===Math.max(a.candleOne_Open,a.candleOne_Close)||.1*d>c),g=b>=.6*d,h=a.isCandleTwo_Bearish&&f&&g,i=a.isCandleTwo_Bullish&&f&&g;return{isBear:i,isBull:h}},CDL.prototype.CDLENGULFING=function(){var a=CDLGETPARAMS(this.priceData),b=(Math.abs(a.candleOne_Low-Math.min(a.candleOne_Open,a.candleOne_Close)),Math.abs(a.candleOne_High-Math.max(a.candleOne_Open,a.candleOne_Close))),c=Math.abs(a.candleOne_Low-a.candleOne_High),d=Math.abs(a.candleOne_Open-a.candleOne_Close),e=((a.candleOne_Open===a.candleOne_Close||.1*c>d)&&(a.candleOne_High===Math.max(a.candleOne_Open,a.candleOne_Close)||.1*c>b),a.isCandleTwo_Bullish&&a.isCandleOne_Bearish&&a.candleTwo_Close<a.candleOne_Open&&a.candleTwo_Open>a.candleOne_Close),f=a.isCandleTwo_Bearish&&a.isCandleOne_Bullish&&a.candleTwo_Close>a.candleOne_Open&&a.candleTwo_Open<a.candleOne_Close;return{isBear:e,isBull:f}},CDL.prototype.CDLEVENINGDOJISTAR=function(){var a=CDLGETPARAMS(this.priceData),b=!1,c=!1;if(a.candleFour_Index>=0)var d=(Math.abs(a.candleOne_Open-a.candleOne_Close),Math.abs(a.candleThree_Open-a.candleThree_Close),Math.abs(a.candleTwo_Low-a.candleTwo_High)),e=a.candleTwo_Open===a.candleTwo_Close||.1*d>=Math.abs(a.candleTwo_Open-a.candleTwo_Close),b=!1,c=a.candleThree_Close>=Math.max(a.candleFour_Close,a.candleFour_Open)&&a.isCandleThree_Bullish&&this.indicators.isLongCandle(a.candleThree_Open,a.candleThree_High,a.candleThree_Low,a.candleThree_Close)&&e&&Math.min(a.candleTwo_Open,a.candleTwo_Close)>a.candleThree_Close&&a.isCandleOne_Bearish&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&a.candleOne_Open<Math.min(a.candleTwo_Open,a.candleTwo_Close)&&a.candleOne_Close>a.candleThree_Open&&a.candleOne_Close<a.candleThree_Close;return{isBear:c,isBull:b}},CDL.prototype.CDLEVENINGSTAR=function(){var a=CDLGETPARAMS(this.priceData),b=!1,c=!1;if(a.candleFour_Index>=0)var d=(Math.abs(a.candleOne_Open-a.candleOne_Close),Math.abs(a.candleTwo_Open-a.candleTwo_Close)),e=Math.abs(a.candleTwo_Low-a.candleTwo_High),b=(Math.abs(a.candleThree_Open-a.candleThree_Close),!1),c=a.candleThree_Close>=Math.max(a.candleFour_Close,a.candleFour_Open)&&a.isCandleThree_Bullish&&this.indicators.isLongCandle(a.candleThree_Open,a.candleThree_High,a.candleThree_Low,a.candleThree_Close)&&d>=.1*e&&Math.min(a.candleTwo_Open,a.candleTwo_Close)>a.candleThree_Close&&a.isCandleOne_Bearish&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&a.candleOne_Open<Math.min(a.candleTwo_Open,a.candleTwo_Close)&&a.candleOne_Close>a.candleThree_Open&&a.candleOne_Close<a.candleThree_Close;return{isBear:c,isBull:b}},CDL.prototype.CDLGAPSIDESIDEWHITE=function(){var a=CDLGETPARAMS(this.priceData),b=a.isCandleThree_Bullish&&a.isCandleTwo_Bullish&&a.candleTwo_Open>a.candleThree_Close&&a.isCandleOne_Bullish&&a.candleOne_Open>a.candleThree_Close&&a.candleOne_Open<a.candleTwo_Close&&a.candleOne_Close<=a.candleTwo_Close+.1*Math.abs(a.candleTwo_Close-a.candleTwo_Open),c=a.isCandleThree_Bearish&&a.isCandleTwo_Bullish&&a.candleTwo_Close<a.candleThree_Close&&a.isCandleOne_Bullish&&a.candleOne_Close<a.candleThree_Close&&a.candleOne_Open<a.candleTwo_Close&&a.candleOne_Close<=a.candleTwo_Close+.1*Math.abs(a.candleTwo_Close-a.candleTwo_Open);return{isBear:c,isBull:b}},CDL.prototype.CDLGRAVESTONEDOJI=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(a.candleOne_High-Math.max(a.candleOne_Open,a.candleOne_Close)),c=Math.abs(a.candleOne_Low-a.candleOne_High),d=(a.candleOne_Open===a.candleOne_Close||.05*c>=Math.abs(a.candleOne_Open-a.candleOne_Close))&&a.candleOne_Low===Math.min(a.candleOne_Open,a.candleOne_Close)||.05*c>=Math.abs(a.candleOne_Low-Math.min(a.candleOne_Open,a.candleOne_Close)),e=b>=.8*c,f=a.isCandleTwo_Bearish&&d&&e,g=a.isCandleTwo_Bullish&&d&&e;return{isBear:g,isBull:f}},CDL.prototype.CDLHAMMER=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(Math.max(a.candleOne_Open,a.candleOne_Close)-a.candleOne_High),c=Math.abs(a.candleOne_Open-a.candleOne_Close),d=Math.abs(a.candleOne_Low-a.candleOne_High),e=Math.abs(a.candleOne_Low-Math.min(a.candleOne_Close,a.candleOne_Open)),f=.4*d>c&&(a.candleOne_High===Math.max(a.candleOne_Open,a.candleOne_Close)||.1*d>b),g=a.isCandleTwo_Bearish&&a.candleTwo_Open<Math.min(a.candleThree_Close,a.candleThree_Open)&&f&&e>=2*c&&a.candleOne_Close<a.candleTwo_Close,h=!1;return{isBear:h,isBull:g}},CDL.prototype.CDLHANGINGMAN=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(Math.max(a.candleOne_Open,a.candleOne_Close)-a.candleOne_High),c=Math.abs(a.candleOne_Open-a.candleOne_Close),d=Math.abs(a.candleOne_Low-a.candleOne_High),e=Math.abs(a.candleOne_Low-Math.min(a.candleOne_Close,a.candleOne_Open)),f=.4*d>c&&(a.candleOne_High===Math.max(a.candleOne_Open,a.candleOne_Close)||.1*d>b),g=a.isCandleTwo_Bullish&&a.candleTwo_Open>Math.max(a.candleThree_Close,a.candleThree_Open)&&f&&a.isCandleOne_Bearish&&e>=2*c&&a.candleOne_Close>a.candleTwo_Close,h=!1,i={isBear:g,isBull:h};return i},CDL.prototype.CDLHARAMI=function(){var a=CDLGETPARAMS(this.priceData),b=a.isCandleTwo_Bearish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.isCandleOne_Bullish&&a.candleOne_Open>a.candleTwo_Close&&a.candleOne_Close<a.candleTwo_Open&&Math.abs(a.candleOne_Open-a.candleOne_Close)<.6*Math.abs(a.candleTwo_Open-a.candleTwo_Close),c=a.isCandleTwo_Bullish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.isCandleOne_Bearish&&a.candleOne_Open<a.candleTwo_Close&&a.candleOne_Close>a.candleTwo_Open&&Math.abs(a.candleOne_Open-a.candleOne_Close)<.6*Math.abs(a.candleTwo_Open-a.candleTwo_Close);return{isBear:c,isBull:b}},CDL.prototype.CDLHARAMICROSS=function(){var a=CDLGETPARAMS(this.priceData),b=this.CDLDOJI(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close),c=a.isCandleTwo_Bearish&&b.isBull&&Math.min(a.candleOne_Close,a.candleOne_Open)>a.candleTwo_Close&&Math.max(a.candleOne_Close,a.candleOne_Open)<a.candleTwo_Open,d=a.isCandleTwo_Bullish&&b.isBear&&Math.min(a.candleOne_Close,a.candleOne_Open)>a.candleTwo_Open&&Math.max(a.candleOne_Close,a.candleOne_Open)<a.candleTwo_Close;return{isBear:d,isBull:c}},CDL.prototype.CDLHOMINGPIGEON=function(){var a=CDLGETPARAMS(this.priceData),b=(Math.abs(a.candleOne_Close-a.candleOne_Open),a.isCandleTwo_Bearish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.isCandleOne_Bearish&&a.candleOne_Low>a.candleTwo_Low&&a.candleOne_Close>a.candleTwo_Close&&a.candleOne_High<a.candleTwo_High&&a.candleOne_Open<a.candleTwo_Open),c=!1;return{isBear:c,isBull:b}},CDL.prototype.CDLHIKKAKE=function(){var a=CDLGETPARAMS(this.priceData),b=!1,c=!1;if(a.candleFour_Index>=0&&a.candleFive_Index>0)var b=Math.max(a.candleFive_Close,a.candleFive_Open)>Math.max(a.candleFour_Close,a.candleFour_Open)&&Math.min(a.candleFive_Close,a.candleFive_Open)<Math.min(a.candleFour_Close,a.candleFour_Open)&&Math.max(a.candleFive_Close,a.candleFive_Open)>Math.max(a.candleThree_Close,a.candleThree_Open)&&Math.max(a.candleFive_Close,a.candleFive_Open)>Math.max(a.candleTwo_Close,a.candleTwo_Open)&&a.isCandleOne_Bullish&&a.candleOne_Close>Math.max(a.candleFive_Close,a.candleFive_Open),c=Math.max(a.candleFive_Close,a.candleFive_Open)>Math.max(a.candleFour_Close,a.candleFour_Open)&&Math.min(a.candleFive_Close,a.candleFive_Open)<Math.min(a.candleFour_Close,a.candleFour_Open)&&Math.min(a.candleFive_Close,a.candleFive_Open)<Math.min(a.candleThree_Close,a.candleThree_Open)&&Math.min(a.candleFive_Close,a.candleFive_Open)<Math.min(a.candleTwo_Close,a.candleTwo_Open)&&a.isCandleOne_Bearish&&a.candleOne_Close<Math.min(a.candleFive_Close,a.candleFive_Open);return{isBull:b,isBear:c}},CDL.prototype.CDLIDENTICAL3CROWS=function(){var a=CDLGETPARAMS(this.priceData),b=!1,c=!1;if(a.candleFour_Index>=0)var d=Math.abs(a.candleThree_Close-a.candleThree_Open),e=Math.abs(a.candleTwo_Close-a.candleTwo_Open),b=(Math.abs(a.candleOne_Close-a.candleOne_Open),!1),c=a.isCandleFour_Bullish&&a.isCandleThree_Bearish&&this.indicators.isLongCandle(a.candleThree_Open,a.candleThree_High,a.candleThree_Low,a.candleThree_Close)&&a.isCandleTwo_Bearish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&(a.candleTwo_Open===a.candleThree_Close||Math.abs(a.candleThree_Close-a.candleTwo_Open)<.1*d)&&a.candleTwo_Close<a.candleThree_Close&&a.isCandleOne_Bearish&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&(a.candleOne_Open===a.candleTwo_Close||Math.abs(a.candleTwo_Close-a.candleOne_Open)<.1*e)&&a.candleOne_Close<a.candleTwo_Close;return{isBull:b,isBear:c}},CDL.prototype.CDLINNECK=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(a.candleTwo_Close-a.candleTwo_Open),c=a.isCandleThree_Bullish&&a.isCandleTwo_Bullish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.isCandleOne_Bearish&&a.candleOne_Open>a.candleTwo_High&&a.candleOne_Close<a.candleTwo_Close&&a.candleOne_Close>a.candleTwo_Close-.1*b,d=a.isCandleThree_Bearish&&a.isCandleTwo_Bearish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.isCandleOne_Bullish&&a.candleOne_Open<a.candleTwo_Low&&a.candleOne_Close>a.candleTwo_Close&&a.candleOne_Close<a.candleTwo_Close+.1*b;return{isBull:c,isBear:d}},CDL.prototype.CDLINVERTEDHAMMER=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(Math.max(a.candleOne_Open,a.candleOne_Close)-a.candleOne_High),c=Math.abs(a.candleOne_Open-a.candleOne_Close),d=Math.abs(a.candleOne_Low-a.candleOne_High),e=Math.abs(a.candleOne_Low-Math.min(a.candleOne_Close,a.candleOne_Open)),f=.4*d>c&&(a.candleOne_Low===Math.min(a.candleOne_Open,a.candleOne_Close)||.1*d>e),g=Math.min(a.candleTwo_Close,a.candleTwo_Open)<Math.min(a.candleThree_Open,a.candleThree_Close)&&Math.min(a.candleOne_Close,a.candleOne_Open)<Math.min(a.candleTwo_Close,a.candleTwo_Open)&&f&&b>=2*c,h=!1;return{isBull:g,isBear:h}},CDL.prototype.CDLKICKING=function(){var a=CDLGETPARAMS(this.priceData),b=this.CDLMARUBOZU(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close),c=this.CDLMARUBOZU(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close),d=c.isBear&&b.isBull&&a.candleOne_Close>a.candleTwo_Open,e=c.isBull&&b.isBear&&a.candleOne_Close<a.candleTwo_Open;return{isBull:d,isBear:e}},CDL.prototype.CDLLADDERBOTTOM=function(){var a=CDLGETPARAMS(this.priceData),b=!1,c=!1;if(a.candleFour_Index>=0&&a.candleFive_Index>0)var b=a.isCandleFive_Bearish&&a.isCandleFour_Bearish&&a.candleFour_Open>a.candleFive_Close&&a.candleFour_Close<a.candleFive_Close&&a.candleFour_Open<a.candleFive_Open&&a.isCandleThree_Bearish&&a.candleThree_Open>a.candleFour_Close&&a.candleThree_Close<a.candleFour_Close&&a.candleThree_Open<a.candleFour_Open&&a.isCandleTwo_Bearish&&a.candleTwo_High>a.candleThree_Close&&a.candleTwo_High>a.candleTwo_Open&&a.candleTwo_Close<a.candleThree_Close&&a.candleTwo_Open<a.candleThree_Open&&a.isCandleOne_Bullish&&a.candleOne_Open>a.candleTwo_Open,c=!1;return{isBull:b,isBear:c}},CDL.prototype.CDLKICKINGBYLENGTH=function(){var a=CDLGETPARAMS(this.priceData),b=this.CDLMARUBOZU(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close),c=this.CDLMARUBOZU(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close),d=c.isBear&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&b.isBull&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&a.candleOne_Close>a.candleTwo_Open,e=c.isBull&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&b.isBear&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&a.candleOne_Close<a.candleTwo_Open;return{isBull:d,isBear:e}},CDL.prototype.CDLLONGLEGGEDDOJI=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(a.candleOne_Low-Math.min(a.candleOne_Open,a.candleOne_Close)),c=Math.abs(a.candleOne_High-Math.max(a.candleOne_Open,a.candleOne_Close)),d=Math.abs(a.candleOne_Low-a.candleOne_High),e=Math.abs(a.candleOne_Open-a.candleOne_Close),f=a.candleOne_Open===a.candleOne_Close||.1*d>e,g=b>=.4*d&&.8*d>=b,h=c>=.4*d&&.8*d>=c,i=a.isCandleTwo_Bearish&&f&&h&&g,j=a.isCandleTwo_Bullish&&f&&h&&g;return{isBull:i,isBear:j}},CDL.prototype.CDLLONGLINE=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(a.candleOne_Low-Math.min(a.candleOne_Open,a.candleOne_Close)),c=Math.abs(a.candleOne_High-Math.max(a.candleOne_Open,a.candleOne_Close)),d=Math.abs(a.candleOne_Low-a.candleOne_High),e=(Math.abs(a.candleOne_Close-a.candleOne_Open),0===b||.1*d>b),f=0===c||.1*d>c,g=a.isCandleOne_Bullish&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&e&&f,h=a.isCandleOne_Bearish&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&e&&f;return{isBull:g,isBear:h}},CDL.prototype.CDLMARUBOZU=function(a,b,c,d){var e=(CDLGETPARAMS(this.priceData),Math.abs(c-Math.min(a,d))),f=Math.abs(b-Math.max(a,d)),g=Math.abs(c-b),h=(Math.abs(d-a),0===e||.05*g>=e),i=0===f||.05*g>=f,j=d>a,k=a>d;return isBearishContinuation=j&&this.indicators.isLongCandle(a,b,c,d)&&i&&h,isBullishContinuation=k&&this.indicators.isLongCandle(a,b,c,d)&&i&&h,{isBull:isBullishContinuation,isBear:isBearishContinuation}},CDL.prototype.CDLMATCHINGLOW=function(){var a=CDLGETPARAMS(this.priceData),b=a.isCandleTwo_Bearish&&a.candleTwo_Open>a.candleOne_Open&&a.isCandleOne_Bearish&&a.candleOne_Close===a.candleTwo_Close,c=!1;return{isBull:b,isBear:c}},CDL.prototype.CDLMATHOLD=function(){var a=CDLGETPARAMS(this.priceData),b=!1,c=!1;if(a.candleFour_Index>=0&&a.candleFive_Index>0)var b=a.isCandleFive_Bullish&&this.indicators.isLongCandle(a.candleFive_Open,a.candleFive_High,a.candleFive_Low,a.candleFive_Close)&&a.isCandleFour_Bearish&&a.candleFour_Close>a.candleFive_Close&&a.isCandleThree_Bearish&&a.candleThree_Close<a.candleFour_Close&&a.isCandleTwo_Bearish&&a.candleTwo_Close<a.candleThree_Close&&a.candleTwo_Close>a.candleFive_Open&&a.isCandleOne_Bullish&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&a.candleOne_Close>a.candleFour_Open,c=a.isCandleFive_Bearish&&this.indicators.isLongCandle(a.candleFive_Open,a.candleFive_High,a.candleFive_Low,a.candleFive_Close)&&a.isCandleFour_Bullish&&a.candleFour_Close<a.candleFive_Close&&a.isCandleThree_Bullish&&a.candleThree_Close>a.candleFour_Close&&a.isCandleTwo_Bullish&&a.candleTwo_Close>a.candleThree_Close&&a.candleTwo_Close<a.candleFive_Open&&a.isCandleOne_Bearish&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&a.candleOne_Close<a.candleFour_Open;return{isBull:b,isBear:c}},CDL.prototype.CDLMORNINGDOJISTAR=function(){var a=CDLGETPARAMS(this.priceData),b=!1,c=!1;

if(a.candleFour_Index>=0)var d=(Math.abs(a.candleOne_Open-a.candleOne_Close),Math.abs(a.candleThree_Open-a.candleThree_Close),Math.abs(a.candleTwo_Low-a.candleTwo_High)),e=a.candleTwo_Open===a.candleTwo_Close||.1*d>=Math.abs(a.candleTwo_Open-a.candleTwo_Close),b=a.candleThree_Close<Math.min(a.candleFour_Close,a.candleFour_Open)&&a.isCandleThree_Bearish&&this.indicators.isLongCandle(a.candleThree_Open,a.candleThree_High,a.candleThree_Low,a.candleThree_Close)&&e&&Math.max(a.candleTwo_Open,a.candleTwo_Close)<a.candleThree_Close&&a.isCandleOne_Bullish&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&a.candleOne_Open>Math.max(a.candleTwo_Open,a.candleTwo_Close)&&a.candleOne_Close<a.candleThree_Open&&a.candleOne_Close>a.candleThree_Close,c=!1;return{isBull:b,isBear:c}},CDL.prototype.CDLMORNINGSTAR=function(){var a=CDLGETPARAMS(this.priceData),b=!1,c=!1;if(a.candleFour_Index>=0)var d=Math.abs(a.candleOne_Open-a.candleOne_Close),e=Math.abs(a.candleTwo_Open-a.candleTwo_Close),f=Math.abs(a.candleThree_Open-a.candleThree_Close),b=a.candleThree_Close<Math.min(a.candleFour_Close,a.candleFour_Open)&&a.isCandleThree_Bearish&&f>3*e&&f/3>e&&Math.max(a.candleTwo_Open,a.candleTwo_Close)<a.candleThree_Close&&a.isCandleOne_Bullish&&d>3*e&&a.candleOne_Open>Math.max(a.candleTwo_Open,a.candleTwo_Close)&&a.candleOne_Close<a.candleThree_Open,c=!1;return{isBull:b,isBear:c}},CDL.prototype.CDLONNECK=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(a.candleTwo_Close-a.candleTwo_Open),c=a.isCandleThree_Bullish&&a.isCandleTwo_Bullish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.isCandleOne_Bearish&&a.candleOne_Open>a.candleTwo_High&&a.candleOne_Close>=a.candleTwo_High&&a.candleOne_Close<=a.candleTwo_High+.1*b,d=a.isCandleThree_Bearish&&a.isCandleTwo_Bearish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.isCandleOne_Bullish&&a.candleOne_Open<a.candleTwo_Low&&a.candleOne_Close<=a.candleTwo_Low&&a.candleOne_Close>=a.candleTwo_Low-.1*b;return{isBull:c,isBear:d}},CDL.prototype.CDLPIERCING=function(){var a=CDLGETPARAMS(this.priceData),b=a.isCandleTwo_Bearish&&a.isCandleOne_Bullish&&a.candleOne_Open<a.candleTwo_Close&&a.candleOne_Close>Math.abs(a.candleTwo_Open+a.candleTwo_Close)/2&&a.candleOne_Close<a.candleTwo_Open,c=!1;return{isBull:b,isBear:c}},CDL.prototype.CDLRICKSHAWMAN=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(a.candleOne_Low-Math.min(a.candleOne_Open,a.candleOne_Close)),c=Math.abs(a.candleOne_High-Math.max(a.candleOne_Open,a.candleOne_Close)),d=Math.abs(a.candleOne_Low-a.candleOne_High),e=Math.abs(a.candleOne_Open-a.candleOne_Close),f=a.candleOne_Open===a.candleOne_Close||.1*d>e,g=b>=.4*d&&.8*d>=b,h=c>=.4*d&&.8*d>=c,i=a.isCandleTwo_Bearish&&f&&h&&g,j=a.isCandleTwo_Bullish&&f&&h&&g;return{isBull:i,isBear:j}},CDL.prototype.CDLRISEFALL3METHODS=function(){var a=CDLGETPARAMS(this.priceData),b=!1,c=!1;if(a.candleFour_Index>=0&&a.candleFive_Index>0)var b=a.isCandleFive_Bullish&&this.indicators.isLongCandle(a.candleFive_Open,a.candleFive_High,a.candleFive_Low,a.candleFive_Close)&&a.candleFour_Low>a.candleFive_Low&&a.candleFour_High<a.candleFive_High&&a.candleThree_Low>a.candleFive_Low&&a.candleThree_High<a.candleFive_High&&a.candleTwo_Low>a.candleFive_Low&&a.candleTwo_High<a.candleFive_High&&a.isCandleOne_Bullish&&a.candleOne_Open>a.candleTwo_Close&&a.candleOne_Close>a.candleFive_Close,c=a.isCandleFive_Bearish&&this.indicators.isLongCandle(a.candleFive_Open,a.candleFive_High,a.candleFive_Low,a.candleFive_Close)&&a.candleFour_Low>a.candleFive_Low&&a.candleFour_High<a.candleFive_High&&a.candleThree_Low>a.candleFive_Low&&a.candleThree_High<a.candleFive_High&&a.candleTwo_Low>a.candleFive_Low&&a.candleTwo_High<a.candleFive_High&&a.isCandleOne_Bearish&&a.candleOne_Open<a.candleTwo_Close&&a.candleOne_Close<a.candleFive_Close;return{isBull:b,isBear:c}},CDL.prototype.CDLSEPARATINGLINES=function(){var a=CDLGETPARAMS(this.priceData),b=a.candleOne_Open>Math.max(a.candleThree_Open,a.candleThree_Close)&&a.isCandleTwo_Bearish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.isCandleOne_Bullish&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&a.candleOne_Open===a.candleTwo_Open,c=a.candleOne_Open<Math.min(a.candleThree_Open,a.candleThree_Close)&&a.isCandleTwo_Bullish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.isCandleOne_Bearish&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&a.candleOne_Open===a.candleTwo_Open;return{isBull:b,isBear:c}},CDL.prototype.CDLSHOOTINGSTAR=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(Math.max(a.candleOne_Open,a.candleOne_Close)-a.candleOne_High),c=Math.abs(a.candleOne_Open-a.candleOne_Close),d=Math.abs(a.candleOne_Low-a.candleOne_High),e=Math.abs(a.candleOne_Low-Math.min(a.candleOne_Close,a.candleOne_Open)),f=.4*d>c&&(a.candleOne_Low===Math.min(a.candleOne_Open,a.candleOne_Close)||.1*d>e),g=Math.max(a.candleTwo_Close,a.candleTwo_Open)>Math.max(a.candleThree_Open,a.candleThree_Close)&&Math.max(a.candleOne_Close,a.candleOne_Open)>Math.max(a.candleTwo_Close,a.candleTwo_Open)&&f&&b>=2*c,h=!1;return{isBull:h,isBear:g}},CDL.prototype.CDLSPINNINGTOP=function(){var a=CDLGETPARAMS(this.priceData),b=a.candleOne_High-Math.max(a.candleOne_Open,a.candleOne_Close),c=Math.min(a.candleOne_Open,a.candleOne_Close)-a.candleOne_Low,d=Math.abs(a.candleOne_High-a.candleOne_Low),e=Math.abs(a.candleOne_Open-a.candleOne_Close),f=a.isCandleTwo_Bearish&&a.candleTwo_Close<Math.min(a.candleThree_Open,a.candleThree_Close)&&a.isCandleOne_Bullish&&a.candleOne_Open<a.candleTwo_Close&&.3*d>=e&&b>e&&.5*d>b&&c>e&&.5*d>c,g=a.isCandleTwo_Bullish&&a.candleTwo_Close>Math.max(a.candleThree_Open,a.candleThree_Close)&&a.isCandleOne_Bearish&&a.candleOne_Open>a.candleTwo_Close&&.3*d>=e&&b>e&&.5*d>b&&c>e&&.5*d>c;return{isBear:g,isBull:f}},CDL.prototype.CDLSTALLEDPATTERN=function(){var a=CDLGETPARAMS(this.priceData),b=(Math.abs(a.candleThree_Close-a.candleThree_Open),Math.abs(a.candleTwo_Close-a.candleTwo_Open),Math.abs(a.candleOne_Close-a.candleOne_Open),a.isCandleThree_Bearish&&this.indicators.isLongCandle(a.candleThree_Open,a.candleThree_High,a.candleThree_Low,a.candleThree_Close)&&a.isCandleTwo_Bearish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.candleTwo_Open<=a.candleThree_Open&&a.isCandleOne_Bearish&&a.candleOne_Open<a.candleTwo_Close),c=a.isCandleThree_Bullish&&this.indicators.isLongCandle(a.candleThree_Open,a.candleThree_High,a.candleThree_Low,a.candleThree_Close)&&a.isCandleTwo_Bullish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.candleTwo_Open>=a.candleThree_Open&&a.isCandleOne_Bullish&&a.candleOne_Open>a.candleTwo_Close;return{isBear:c,isBull:b}},CDL.prototype.CDLSTICKSANDWICH=function(){var a=CDLGETPARAMS(this.priceData),b=!1,c=!1;if(a.candleFour_Index>=0)var d=Math.abs(a.candleThree_Close-a.candleThree_Open),e=a.candleOne_Close===a.candleThree_Close||a.candleOne_Close<=a.candleThree_Close+.05*d||a.candleOne_Close>=a.candleThree_Close-.05*d,b=a.isCandleThree_Bearish&&this.indicators.isLongCandle(a.candleThree_Open,a.candleThree_High,a.candleThree_Low,a.candleThree_Close)&&a.candleThree_Close<Math.min(a.candleFour_Close,a.candleFour_Open)&&a.isCandleTwo_Bullish&&a.candleTwo_Close>a.candleThree_Open&&a.candleTwo_Open>a.candleThree_Close&&a.candleTwo_Open<a.candleThree_Open&&a.isCandleOne_Bearish&&a.candleOne_Open>a.candleTwo_Close&&a.candleOne_Close<a.candleTwo_Open&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&e,c=a.isCandleThree_Bullish&&this.indicators.isLongCandle(a.candleThree_Open,a.candleThree_High,a.candleThree_Low,a.candleThree_Close)&&a.candleThree_Close>Math.max(a.candleFour_Close,a.candleFour_Open)&&a.isCandleTwo_Bearish&&a.candleTwo_Close<a.candleThree_Open&&a.candleTwo_Open<a.candleThree_Close&&a.candleTwo_Open>a.candleThree_Open&&a.isCandleOne_Bullish&&a.candleOne_Open<a.candleTwo_Close&&a.candleOne_Close>a.candleTwo_Open&&this.indicators.isLongCandle(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close)&&e;return{isBull:b,isBear:c}},CDL.prototype.CDLTAKURI=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(a.candleOne_Low-Math.min(a.candleOne_Open,a.candleOne_Close)),c=Math.abs(a.candleOne_High-Math.max(a.candleOne_Open,a.candleOne_Close)),d=Math.abs(a.candleOne_Low-a.candleOne_High),e=Math.abs(a.candleOne_Open-a.candleOne_Close),f=(a.candleOne_Open===a.candleOne_Close||.2*d>e)&&(a.candleOne_High===Math.max(a.candleOne_Open,a.candleOne_Close)||.2*d>c),g=b>=.8*d,h=a.isCandleTwo_Bearish&&f&&g,i=a.isCandleTwo_Bullish&&f&&g;return{isBull:h,isBear:i}},CDL.prototype.CDLTASUKIGAP=function(){var a=CDLGETPARAMS(this.priceData),b=a.isCandleThree_Bullish&&a.isCandleTwo_Bullish&&a.candleTwo_Open>a.candleThree_Close&&a.isCandleOne_Bearish&&a.candleOne_Open>a.candleTwo_Open&&a.candleOne_Open<a.candleTwo_Close&&a.candleOne_Close<a.candleTwo_Open&&a.candleOne_Close>a.candleThree_Close,c=a.isCandleThree_Bearish&&a.isCandleTwo_Bearish&&a.candleTwo_Open<a.candleThree_Close&&a.isCandleOne_Bullish&&a.candleOne_Open>a.candleTwo_Close&&a.candleOne_Open<a.candleTwo_Open&&a.candleOne_Close<a.candleThree_Close&&a.candleOne_Close>a.candleTwo_Open;return{isBear:c,isBull:b}},CDL.prototype.CDLTHRUSTING=function(){var a=CDLGETPARAMS(this.priceData),b=a.isCandleTwo_Bearish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.isCandleOne_Bullish&&a.candleOne_Open<a.candleTwo_Close&&a.candleOne_Close<=a.candleTwo_Close+Math.abs(a.candleTwo_Open-a.candleTwo_Close)/2&&a.candleOne_Close>=a.candleTwo_Close,c=a.isCandleTwo_Bullish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.isCandleOne_Bearish&&a.candleOne_Open>a.candleTwo_Close&&a.candleOne_Close>=a.candleTwo_Close-Math.abs(a.candleTwo_Open-a.candleTwo_Close)/2&&a.candleOne_Close<=a.candleTwo_Close;return{isBull:c,isBear:b}},CDL.prototype.CDLTRISTAR=function(){var a=CDLGETPARAMS(this.priceData),b=this.CDLDOJI(a.candleThree_Open,a.candleThree_High,a.candleThree_Low,a.candleThree_Close),c=this.CDLDOJI(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close),d=this.CDLDOJI(a.candleOne_Open,a.candleOne_High,a.candleOne_Low,a.candleOne_Close),e=b.isDoji&&c.isDoji&&Math.max(a.candleTwo_Close,a.candleTwo_Open)<Math.min(a.candleThree_Close,a.candleThree_Open)&&Math.max(a.candleTwo_Close,a.candleTwo_Open)<Math.min(a.candleOne_Close,a.candleOne_Open)&&d.isDoji,f=b.isDoji&&c.isDoji&&Math.min(a.candleTwo_Close,a.candleTwo_Open)>Math.max(a.candleThree_Close,a.candleThree_Open)&&Math.min(a.candleTwo_Close,a.candleTwo_Open)>Math.max(a.candleOne_Close,a.candleOne_Open)&&d.isDoji;return{isBear:f,isBull:e}},CDL.prototype.CDLUNIQUE3RIVER=function(){var a=CDLGETPARAMS(this.priceData),b=!1,c=!1,b=(Math.abs(a.candleTwo_Open-a.candleTwo_High),Math.abs(a.candleTwo_Open-a.candleTwo_Close),Math.abs(a.candleTwo_Low-a.candleTwo_Close),Math.abs(a.candleThree_Close-a.candleThree_Open),a.isCandleThree_Bearish&&this.indicators.isLongCandle(a.candleThree_Open,a.candleThree_High,a.candleThree_Low,a.candleThree_Close)&&a.isCandleTwo_Bearish&&a.candleTwo_Close>a.candleThree_Close&&a.candleTwo_Open<a.candleThree_Open&&a.candleTwo_Low<a.candleThree_Low&&a.isCandleOne_Bullish&&a.candleOne_Close<a.candleTwo_Close),c=!1;return{isBull:b,isBear:c}},CDL.prototype.CDLUPSIDEGAP2CROWS=function(){var a=CDLGETPARAMS(this.priceData),b=a.isCandleThree_Bullish&&this.indicators.isLongCandle(a.candleThree_Open,a.candleThree_High,a.candleThree_Low,a.candleThree_Close)&&a.isCandleTwo_Bearish&&a.candleTwo_Close>a.candleThree_Close&&a.isCandleOne_Bearish&&a.candleOne_Close<a.candleTwo_Close&&a.candleOne_Open>a.candleTwo_Open&&a.candleOne_Close>a.candleThree_Close,c=!1;return{isBear:c,isBull:b}},CDL.prototype.CDLXSIDEGAP3METHODS=function(){var a=CDLGETPARAMS(this.priceData),b=a.isCandleThree_Bullish&&this.indicators.isLongCandle(a.candleThree_Open,a.candleThree_High,a.candleThree_Low,a.candleThree_Close)&&a.isCandleTwo_Bullish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.candleTwo_Open>a.candleThree_Close&&a.isCandleOne_Bearish&&a.candleOne_Open>a.candleTwo_Open&&a.candleOne_Open<a.candleTwo_Close&&a.candleOne_Close<a.candleThree_Close&&a.candleOne_Close>a.candleThree_Open,c=a.isCandleThree_Bearish&&this.indicators.isLongCandle(a.candleThree_Open,a.candleThree_High,a.candleThree_Low,a.candleThree_Close)&&a.isCandleTwo_Bearish&&this.indicators.isLongCandle(a.candleTwo_Open,a.candleTwo_High,a.candleTwo_Low,a.candleTwo_Close)&&a.candleTwo_Open<a.candleThree_Close&&a.isCandleOne_Bullish&&a.candleOne_Open<a.candleTwo_Open&&a.candleOne_Open>a.candleTwo_Close&&a.candleOne_Close>a.candleThree_Close&&a.candleOne_Close<a.candleThree_Open;return{isBear:c,isBull:b}},CDL.prototype.CDLHIGHWAVE=function(){var a=CDLGETPARAMS(this.priceData),b=Math.abs(a.candleOne_Close-a.candleOne_Open),c=(Math.abs(a.candleOne_High-a.candleOne_Low),Math.abs(a.candleOne_High-Math.max(a.candleOne_Open,a.candleOne_Close))),d=Math.abs(Math.min(a.candleOne_Open,a.candleOne_Close)-a.candleOne_Low),e=a.isCandleOne_Bearish&&b>.05*Math.max(c,d)&&d/3>b&&c/3>b,f=a.isCandleOne_Bullish&&b>.05*Math.max(c,d)&&d/3>b&&c/3>b;return{isBear:e,isBull:f}},CDL.prototype.calculateIndicatorValue=function(a){var b,c=this.priceData[this.priceData.length-1].time;switch(a.toUpperCase()){case"CDL2CROWS":var d=this.CDL2CROWS();b=CDLADDFLAGINFO(d,c,"TC","Two crows");break;case"CDLDOJI":var e=this.priceData.length-1,f=this.priceData[e].open,g=this.priceData[e].high,h=this.priceData[e].low,i=this.priceData[e].close,d=this.CDLDOJI(f,g,h,i);b=CDLADDFLAGINFO(d,c,"D","Doji");break;case"CDL3BLACKCROWS":var d=this.CDL3BLACKCROWS();b=CDLADDFLAGINFO(d,c,"TBC","Three Black crows");break;case"CDL3INSIDE":var d=this.CDL3INSIDE();b=CDLADDFLAGINFO(d,c,"TIUD","Three Inside Up/Down");break;case"CDL3LINESTRIKE":var d=this.CDL3LINESTRIKE();b=CDLADDFLAGINFO(d,c,"TLS","Three-Line Strike");break;case"CDL3OUTSIDE":var d=this.CDL3OUTSIDE();b=CDLADDFLAGINFO(d,c,"TOUD","Three Outside Up/Down");break;case"CDL3STARSSOUTH":var d=this.CDL3STARSSOUTH();b=CDLADDFLAGINFO(d,c,"TSS","Three Stars In The South");break;case"CDL3WHITESOLDIERS":var d=this.CDL3WHITESOLDIERS();b=CDLADDFLAGINFO(d,c,"TWS","Three Advancing White Soldiers");break;case"CDLABANDONEDBABY":var d=this.CDLABANDONEDBABY();b=CDLADDFLAGINFO(d,c,"AB","Abandoned Baby");break;case"CDLADVANCEBLOCK":var d=this.CDLADVANCEBLOCK();b=CDLADDFLAGINFO(d,c,"AB","Advance Block");break;case"CDLBELTHOLD":var d=this.CDLBELTHOLD();b=CDLADDFLAGINFO(d,c,"BH","Belt-hold");break;case"CDLBREAKAWAY":var d=this.CDLBREAKAWAY();b=CDLADDFLAGINFO(d,c,"BA","Breakaway");break;case"CDLCLOSINGMARUBOZU":var d=this.CDLCLOSINGMARUBOZU();b=CDLADDFLAGINFO(d,c,"CM","Closing Marubozu");break;case"CDLCOUNTERATTACK":var d=this.CDLCOUNTERATTACK();b=CDLADDFLAGINFO(d,c,"CA","Counterattack");break;case"CDLDARKCLOUDCOVER":var d=this.CDLDARKCLOUDCOVER();b=CDLADDFLAGINFO(d,c,"DCC","Dark Cloud Cover");break;case"CDLDOJISTAR":var d=this.CDLDOJISTAR();b=CDLADDFLAGINFO(d,c,"DS","Doji Star");break;case"CDLDRAGONFLYDOJI":var d=this.CDLDRAGONFLYDOJI();b=CDLADDFLAGINFO(d,c,"DD","Dragonfly Doji");break;case"CDLENGULFING":var d=this.CDLENGULFING();b=CDLADDFLAGINFO(d,c,"EP","Engulfing Pattern");break;case"CDLEVENINGDOJISTAR":var d=this.CDLEVENINGDOJISTAR();b=CDLADDFLAGINFO(d,c,"EDS","Evening Doji Star");break;case"CDLEVENINGSTAR":var d=this.CDLEVENINGSTAR();b=CDLADDFLAGINFO(d,c,"ES","Evening Star");break;case"CDLGAPSIDESIDEWHITE":var d=this.CDLGAPSIDESIDEWHITE();b=CDLADDFLAGINFO(d,c,"SSWL","Up/Down-Gap Side-By-Side White Lines");break;case"CDLGRAVESTONEDOJI":var d=this.CDLGRAVESTONEDOJI();b=CDLADDFLAGINFO(d,c,"GSD","Gravestone Doji");break;case"CDLHAMMER":var d=this.CDLHAMMER();b=CDLADDFLAGINFO(d,c,"H","Hammer");break;case"CDLHANGINGMAN":var d=this.CDLHANGINGMAN();b=CDLADDFLAGINFO(d,c,"HM","Hanging Man");break;case"CDLHARAMI":var d=this.CDLHARAMI();b=CDLADDFLAGINFO(d,c,"HP","Harami Pattern");break;case"CDLHARAMICROSS":var d=this.CDLHARAMICROSS();b=CDLADDFLAGINFO(d,c,"HCP","Harami Cross Pattern");break;case"CDLHOMINGPIGEON":var d=this.CDLHOMINGPIGEON();b=CDLADDFLAGINFO(d,c,"HP","Homing Pigeon");break;case"CDLHIKKAKE":var d=this.CDLHIKKAKE();b=CDLADDFLAGINFO(d,c,"HP","Hikkake Pattern");break;case"CDLHIGHWAVE":var d=this.CDLHIGHWAVE();b=CDLADDFLAGINFO(d,c,"HW","High Wave");break;case"CDLIDENTICAL3CROWS":var d=this.CDLIDENTICAL3CROWS();b=CDLADDFLAGINFO(d,c,"ITC","Identical Three Crows");break;case"CDLINNECK":var d=this.CDLINNECK();b=CDLADDFLAGINFO(d,c,"IN","In-Neck");break;case"CDLINVERTEDHAMMER":var d=this.CDLINVERTEDHAMMER();b=CDLADDFLAGINFO(d,c,"IH","Inverted Hammer");break;case"CDLKICKING":var d=this.CDLKICKING();b=CDLADDFLAGINFO(d,c,"KC","Kicking");break;case"CDLKICKINGBYLENGTH":var d=this.CDLKICKINGBYLENGTH();b=CDLADDFLAGINFO(d,c,"KCWLM","Kicking (longer marubozu)");break;case"CDLLADDERBOTTOM":var d=this.CDLLADDERBOTTOM();b=CDLADDFLAGINFO(d,c,"LB","Ladder Bottom");break;case"CDLLONGLEGGEDDOJI":var d=this.CDLLONGLEGGEDDOJI();b=CDLADDFLAGINFO(d,c,"LLD","Long Legged Doji");break;case"CDLLONGLINE":var d=this.CDLLONGLINE();b=CDLADDFLAGINFO(d,c,"LLC","Long Line Candle");break;case"CDLMARUBOZU":var e=this.priceData.length-1,f=this.priceData[e].open,g=this.priceData[e].high,h=this.priceData[e].low,i=this.priceData[e].close,d=this.CDLMARUBOZU(f,g,h,i);b=CDLADDFLAGINFO(d,c,"MZ","Marubozu");break;case"CDLMATCHINGLOW":var d=this.CDLMATCHINGLOW();b=CDLADDFLAGINFO(d,c,"ML","Matching Low");break;case"CDLMATHOLD":var d=this.CDLMATHOLD();b=CDLADDFLAGINFO(d,c,"MH","Mat Hold");break;case"CDLMORNINGDOJISTAR":var d=this.CDLMORNINGDOJISTAR();b=CDLADDFLAGINFO(d,c,"MDS","Morning Doji Star");break;case"CDLMORNINGSTAR":var d=this.CDLMORNINGSTAR();b=CDLADDFLAGINFO(d,c,"MS","Morning Star");break;case"CDLONNECK":var d=this.CDLONNECK();b=CDLADDFLAGINFO(d,c,"ON","On-Neck");break;case"CDLPIERCING":var d=this.CDLPIERCING();b=CDLADDFLAGINFO(d,c,"PP","Piercing Pattern");break;case"CDLRICKSHAWMAN":var d=this.CDLRICKSHAWMAN();b=CDLADDFLAGINFO(d,c,"RM","Rickshaw Man");break;case"CDLRISEFALL3METHODS":var d=this.CDLRISEFALL3METHODS();b=CDLADDFLAGINFO(d,c,"FTM","Falling Three Methods");break;case"CDLSEPARATINGLINES":var d=this.CDLSEPARATINGLINES();b=CDLADDFLAGINFO(d,c,"SL","Separating Lines");break;case"CDLSHOOTINGSTAR":var d=this.CDLSHOOTINGSTAR();b=CDLADDFLAGINFO(d,c,"SS","Shooting Star");break;case"CDLSPINNINGTOP":var d=this.CDLSPINNINGTOP();b=CDLADDFLAGINFO(d,c,"ST","Spinning Top");break;case"CDLSTALLEDPATTERN":var d=this.CDLSTALLEDPATTERN();b=CDLADDFLAGINFO(d,c,"SP","Stalled Pattern");break;case"CDLSTICKSANDWICH":var d=this.CDLSTICKSANDWICH();b=CDLADDFLAGINFO(d,c,"SS","Stick Sandwich");break;case"CDLTAKURI":var d=this.CDLTAKURI();b=CDLADDFLAGINFO(d,c,"TK","Takuri");break;case"CDLTASUKIGAP":var d=this.CDLTASUKIGAP();b=CDLADDFLAGINFO(d,c,"TG","Tasuki Gap");break;case"CDLTHRUSTING":var d=this.CDLTHRUSTING();b=CDLADDFLAGINFO(d,c,"TP","Thrusting Pattern");break;case"CDLTRISTAR":var d=this.CDLTRISTAR();b=CDLADDFLAGINFO(d,c,"TSP","Tristar Pattern");break;case"CDLUNIQUE3RIVER":var d=this.CDLUNIQUE3RIVER();b=CDLADDFLAGINFO(d,c,"U3R","Unique 3 River");break;case"CDLUPSIDEGAP2CROWS":var d=this.CDLUPSIDEGAP2CROWS();b=CDLADDFLAGINFO(d,c,"UGTC","Upside Gap Two Crows");break;case"CDLXSIDEGAP3METHODS":var d=this.CDLXSIDEGAP3METHODS();b=CDLADDFLAGINFO(d,c,"GTM","Upside/Downside Gap Three Methods")}return b},CDLADDFLAGINFO=function(a,b,c,d){var e;return a.isBull?e={x:b,title:'<span style="color : blue">'+c+"</span>",text:d+" : Bull"}:a.isBear&&(e={x:b,title:'<span style="color : red">'+c+"</span>",text:d+" : Bear"}),e},CDLGETPARAMS=function(a){var b=a.length-1,c=b-1,d=b-2,e=b-3,f=b-4,g={candleOne_Open:a[b].open,candleOne_Close:a[b].close,candleOne_High:a[b].high,candleOne_Low:a[b].low,candleTwo_Open:a[c].open,candleTwo_Close:a[c].close,candleTwo_High:a[c].high,candleTwo_Low:a[c].low,candleThree_Open:a[d].open,candleThree_Close:a[d].close,candleThree_High:a[d].high,candleThree_Low:a[d].low,isCandleOne_Bullish:a[b].close>a[b].open,isCandleOne_Bearish:a[b].close<a[b].open,isCandleTwo_Bullish:a[c].close>a[c].open,isCandleTwo_Bearish:a[c].close<a[c].open,isCandleThree_Bullish:a[d].close>a[d].open,isCandleThree_Bearish:a[d].close<a[d].open};return g.candleFour_Index=e,e>=0&&(g.candleFour_Open=a[e].open,g.candleFour_Close=a[e].close,g.candleFour_High=a[e].high,g.candleFour_Low=a[e].low,g.isCandleFour_Bullish=a[e].close>a[e].open,g.isCandleFour_Bearish=a[e].close<a[e].open),g.candleFive_Index=f,f>=0&&(g.candleFive_Open=a[f].open,g.candleFive_Close=a[f].close,g.candleFive_High=a[f].high,g.candleFive_Low=a[f].low,g.isCandleFive_Bullish=a[f].close>a[f].open,g.isCandleFive_Bearish=a[f].close<a[f].open),g},CHOP=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.calculateCHOPValue=function(a,b){for(var c=0,d=a[b].high,e=a[b].low,f=0;f<this.options.period;f++)c+=this.atr.indicatorData[b-f].value,d=Math.max(a[b-f].high,d),e=Math.min(a[b-f].low,e);var g=0;return d-e!==0&&(g=100*Math.log10(c/(d-e))/Math.log10(this.options.period)),toFixed(g,4)},this.atr=new ATR(a,{period:this.options.atrPeriod,appliedTo:this.options.appliedTo},c);for(var d=0;d<a.length;d++){if(d>=b.period){var e=this.calculateCHOPValue(a,d);this.indicatorData.push({time:a[d].time,value:e})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},CHOP.prototype=Object.create(IndicatorBase.prototype),CHOP.prototype.constructor=CHOP,CHOP.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1;this.atr.addPoint(a)[0].value;var c=this.calculateCHOPValue(this.priceData,b);return this.indicatorData.push({time:a.time,value:c}),[{id:this.uniqueID,value:c}]},CHOP.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close,this.atr.update(a)[0].value;var c=this.calculateCHOPValue(this.priceData,b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},CHOP.prototype.toString=function(){return"CHOP ("+this.options.period+", "+this.options.atrPeriod+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},CKS=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.highStops=[],this.lowStops=[],this.shortStops=[],this.uniqueID=[uuid(),uuid()],this.atr=new ATR(a,b,c),this.calculateStopValue=function(a,b){for(var c=a[b].high,d=a[b].low,e=0;e<this.options.period;e++)b-e>0&&(c=Math.max(a[b-e].high,c),d=Math.min(a[b-e].low,d));var f=c-this.options.multiplier*this.atr.indicatorData[b].value,g=d+this.options.multiplier*this.atr.indicatorData[b].value;return{highStop:f,lowStop:g}},this.calculateCKSValue=function(a){for(var b=this.highStops[a].value,c=this.lowStops[a].value,d=0;d<this.options.maxMinPeriod;d++)a-d>0&&(b=Math.max(this.highStops[a-d].value,b),c=Math.min(this.lowStops[a-d].value,c));return{longStop:toFixed(b,4),shortStop:toFixed(c,4)}};for(var d=0;d<a.length;d++){var e=this.calculateStopValue(a,d);this.highStops.push({time:a[d].time,value:e.highStop}),this.lowStops.push({time:a[d].time,value:e.lowStop})}for(var d=0;d<a.length;d++){if(d>=this.options.period){var f=this.calculateCKSValue(d);this.indicatorData.push({time:a[d].time,value:f.longStop}),this.shortStops.push({time:a[d].time,value:f.shortStop})}else this.indicatorData.push({time:a[d].time,value:0}),this.shortStops.push({time:a[d].time,value:0});this.priceData.push(a[d])}},CKS.prototype=Object.create(IndicatorBase.prototype),CKS.prototype.constructor=CKS,CKS.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1,c=(this.atr.addPoint(a)[0].value,this.calculateStopValue(this.priceData,b));this.highStops.push({time:a.time,value:c.highStop}),this.lowStops.push({time:a.time,value:c.lowStop});var d=this.calculateCKSValue(b);return this.indicatorData.push({time:a.time,value:d.longStop}),this.shortStops.push({time:a.time,value:d.shortStop}),[{id:this.uniqueID[1],value:d.longStop},{id:this.uniqueID[0],value:d.shortStop}]},CKS.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=(this.atr.update(a)[0].value,this.calculateStopValue(this.priceData,b));this.highStops[b].value=c.highStop,this.lowStops[b].value=c.lowStop;var d=this.calculateCKSValue(b);return this.indicatorData[b].value=d.longStop,this.shortStops[b].value=d.shortStop,[{id:this.uniqueID[1],value:d.longStop},{id:this.uniqueID[0],value:d.shortStop}]},CKS.prototype.toString=function(){return"CKS ("+this.options.period+", "+this.options.maxMinPeriod+", "+this.options.multiplier+")"},CKS.prototype.buildSeriesAndAxisConfFromData=function(){var a=[];this.indicatorData.forEach(function(b){a.push([b.time,b.value])});var b=[];return this.shortStops.forEach(function(a){b.push([a.time,a.value])}),[{seriesConf:{id:this.uniqueID[0],name:"Short Stop - "+this.toString(),data:b,type:"line",color:this.options.shortStopStroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!0}},{seriesConf:{id:this.uniqueID[1],name:"Long Stop - "+this.toString(),data:a,type:"line",color:this.options.longStopStroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!0}}]},CKS.prototype.getIDs=function(){return this.uniqueID},CKS.prototype.isSameInstance=function(a){return _.isEqual(a.sort(),this.uniqueID)},CMO=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.CalculateCMOValue=function(a){for(var b=0,c=0,d=0;d<this.options.period;d++)b+=this.posData[a-d].value,c+=this.negData[a-d].value;return{sumPos:b,sumNeg:c}},this.CalculatePosNegValue=function(a,b){var c=this.indicators.getIndicatorOrPriceValue(a[b],this.options.appliedTo)-this.indicators.getIndicatorOrPriceValue(a[b-1],this.options.appliedTo),d=0,e=0;return c>0&&(d=c),0>c&&(e=Math.abs(c)),{pos:d,neg:e}},this.posData=[{time:a[0].time,close:0}],this.negData=[{time:a[0].time,close:0}];for(var d=1;d<a.length;d++){var e=this.CalculatePosNegValue(a,d);this.posData.push({time:a[d].time,value:e.pos}),this.negData.push({time:a[d].time,value:e.neg})}for(var d=0;d<a.length;d++){if(d>=this.options.period-1){var f=this.CalculateCMOValue(d),g=0;f.sumPos+f.sumNeg!==0&&(g=toFixed((f.sumPos-f.sumNeg)/(f.sumPos+f.sumNeg)*100,4)),this.indicatorData.push({time:a[d].time,value:g})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},CMO.prototype=Object.create(IndicatorBase.prototype),CMO.prototype.constructor=CMO,CMO.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1,c=this.CalculatePosNegValue(this.priceData,b);this.posData.push({time:a.time,value:c.pos}),this.negData.push({time:a.time,value:c.neg});var d=this.CalculateCMOValue(b),e=d.sumPos+d.sumNeg!==0?toFixed((d.sumPos-d.sumNeg)/(d.sumPos+d.sumNeg)*100,4):0;return this.indicatorData.push({time:a.time,value:e}),[{id:this.uniqueID,value:e}]},CMO.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.CalculatePosNegValue(this.priceData,b);this.posData[b].value=c.pos,this.negData[b].value=c.neg;var d=this.CalculateCMOValue(b),e=d.sumPos+d.sumNeg!==0?toFixed((d.sumPos-d.sumNeg)/(d.sumPos+d.sumNeg)*100,4):0;return this.indicatorData[b].value=e,[{id:this.uniqueID,value:e}]},CMO.prototype.toString=function(){return"CMO ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},DC=function(a,b,c){IndicatorBase.call(this,a,b,c),this.lowData=[],this.areaRangeData=[],this.priceData=[],this.uniqueID=[uuid(),uuid(),uuid()],this.calculateDCValue=function(a,b){for(var c=a[b].high,d=a[b].low,e=0;e<this.options.period;e++)b-e>=0&&(c=Math.max(a[b-e].high,c),d=Math.min(a[b-e].low,d));return{highestHigh:c,lowestLow:d}};for(var d=0;d<a.length;d++){var e=this.calculateDCValue(a,d);this.indicatorData.push({time:a[d].time,value:e.highestHigh}),this.lowData.push({time:a[d].time,value:e.lowestLow}),this.areaRangeData.push({time:a[d].time,value:[e.highestHigh,e.lowestLow]}),this.priceData.push(a[d])}},DC.prototype=Object.create(IndicatorBase.prototype),DC.prototype.constructor=DC,DC.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1,c=this.calculateDCValue(this.priceData,b);return this.indicatorData.push({time:a.time,value:c.highestHigh}),this.lowData.push({time:a.time,value:c.lowestLow}),this.areaRangeData.push({time:a.time,value:[c.highestHigh,c.lowestLow]}),[{id:this.uniqueID[0],value:c.highestHigh},{id:this.uniqueID[1],value:c.lowestLow},{id:this.uniqueID[2],value:[c.highestHigh,c.lowestLow]}]},DC.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.calculateDCValue(this.priceData,b);return this.indicatorData[b].value=c.highestHigh,this.lowData[b].value=c.lowestLow,this.areaRangeData[b].value=c.lowestLow,[{id:this.uniqueID[0],value:c.highestHigh},{id:this.uniqueID[1],value:c.lowestLow},{id:this.uniqueID[2],value:[c.highestHigh,c.lowestLow]}]},DC.prototype.toString=function(){return"DC ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},DC.prototype.buildSeriesAndAxisConfFromData=function(){var a=[];this.indicatorData.forEach(function(b){a.push([b.time,b.value])});var b=[];this.lowData.forEach(function(a){b.push([a.time,a.value])});var c=[];return this.areaRangeData.forEach(function(a){c.push(_.flattenDeep([a.time,a.value]))}),[{seriesConf:{id:this.uniqueID[0],name:"High - "+this.toString(),data:a,type:"line",color:this.options.highStroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!0}},{seriesConf:{id:this.uniqueID[1],name:"Low - "+this.toString(),data:b,type:"line",color:this.options.lowStroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!0}},{seriesConf:{id:this.uniqueID[2],data:c,name:"DC Range",type:"arearange",color:"white",fillColor:"rgba(28,28,28,0.2)",connectNulls:!0,states:{hover:{enabled:!1}},events:{},dataLabels:{enabled:!1},point:{events:{}},enableMouseTracking:!1,onChartIndicator:!0}}]},DC.prototype.getIDs=function(){return this.uniqueID},DC.prototype.isSameInstance=function(a){return _.isEqual(a.sort(),this.uniqueID)},DEMA=function(a,b,c){IndicatorBase.call(this,a,b,c),this.ema1=null,this.ema2=null,this.ema1=new EMA(a,{period:b.period,appliedTo:b.appliedTo},c);var d=[];this.ema1.indicatorData.forEach(function(a){d.push({time:a.time,close:a.value})}),this.ema2=new EMA(d,{period:b.period,appliedTo:c.CLOSE},c);for(var e=0;e<a.length;e++){var f=this.ema1.indicatorData[e].value,g=this.ema2.indicatorData[e].value,h=toFixed(2*f-g,4);this.indicatorData.push({time:a[e].time,value:h||null})}},DEMA.prototype=Object.create(IndicatorBase.prototype),DEMA.prototype.constructor=DEMA,DEMA.prototype.addPoint=function(a){var b=this.ema1.addPoint(a)[0].value,c=this.ema2.addPoint({time:a.time,close:b})[0].value,d=toFixed(2*b-c,4);return this.indicatorData.push({time:a.time,value:d}),[{id:this.uniqueID,value:d}]},DEMA.prototype.update=function(a){var b=this.indicatorData.length-1,c=this.ema1.update(a)[0].value,d=this.ema2.update({time:a.time,close:c})[0].value,e=toFixed(2*c-d,4);return this.indicatorData[b].value=e,[{id:this.uniqueID,value:e}]},DEMA.prototype.toString=function(){return"DEMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")";

},DX=function(a,b,c){IndicatorBase.call(this,a,b,c),this.uniqueID=[uuid(),uuid(),uuid()],this.adx=new ADX(a,b,c),this.plusDIData=this.adx.PlusDI.indicatorData,this.minusData=this.adx.MinusDI.indicatorData,this.indicatorData=this.adx.indicatorData},DX.prototype=Object.create(IndicatorBase.prototype),DX.prototype.constructor=DX,DX.prototype.addPoint=function(a){var b=this.adx.addPoint(a)[0].value;return this.plusDIData=this.adx.PlusDI.indicatorData,this.minusData=this.adx.MinusDI.indicatorData,this.indicatorData=this.adx.indicatorData,[{id:this.uniqueID[0],value:b},{id:this.uniqueID[1],value:this.plusDIData[this.plusDIData.length-1].value},{id:this.uniqueID[2],value:this.minusData[this.minusData.length-1].value}]},DX.prototype.update=function(a){var b=this.adx.update(a)[0].value;return this.plusDIData=this.adx.PlusDI.indicatorData,this.minusData=this.adx.MinusDI.indicatorData,this.indicatorData=this.adx.indicatorData,[{id:this.uniqueID[0],value:b},{id:this.uniqueID[1],value:this.plusDIData[this.plusDIData.length-1].value},{id:this.uniqueID[2],value:this.minusData[this.minusData.length-1].value}]},DX.prototype.toString=function(){return"DX ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},DX.prototype.buildSeriesAndAxisConfFromData=function(a){var b=[];this.indicatorData.forEach(function(a){b.push([a.time,a.value])});var c=[];this.plusDIData.forEach(function(a){c.push([a.time,a.value])});var d=[];return this.minusData.forEach(function(a){d.push([a.time,a.value])}),[{axisConf:{id:a.id+"-"+this.uniqueID[0],title:{text:this.toString(),align:"high",offset:0,rotation:0,y:10,x:30+7.5*this.toString().length},lineWidth:2,plotLines:this.options.levels}},{seriesConf:{id:this.uniqueID[0],name:"ADX "+this.toString(),data:b,type:"line",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.dxStroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}},{seriesConf:{id:this.uniqueID[1],name:"+DI "+this.toString(),data:c,type:"line",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.plusDIStroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}},{seriesConf:{id:this.uniqueID[2],name:"-DI "+this.toString(),data:d,type:"line",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.minusDIStroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}}]},DX.prototype.getIDs=function(){return this.uniqueID},DX.prototype.isSameInstance=function(a){return _.isEqual(a.sort(),this.uniqueID)},EMA=function(a,b,c){IndicatorBase.call(this,a,b,c);for(var d=0;d<a.length;d++)if(d===this.options.period-1){for(var e=0,f=this.options.period-1;f>=0;f--)e+=c.getIndicatorOrPriceValue(a[d-f],this.options.appliedTo);var g=toFixed(e/this.options.period,4);this.indicatorData.push({time:a[d].time,value:g})}else if(d>this.options.period-1){var h=this.indicatorData[d-1].value,i=c.getIndicatorOrPriceValue(a[d],this.options.appliedTo),j=2*i/(this.options.period+1)+h*(1-2/(this.options.period+1));j=toFixed(j,4),this.indicatorData.push({time:a[d].time,value:j})}else this.indicatorData.push({time:a[d].time,value:null})},EMA.prototype=Object.create(IndicatorBase.prototype),EMA.prototype.constructor=EMA,EMA.prototype.addPoint=function(a){var b=this.indicatorData.length-1,c=this.indicatorData[b].value,d=this.indicators.getIndicatorOrPriceValue(a,this.options.appliedTo),e=2*d/(this.options.period+1)+c*(1-2/(this.options.period+1));return e=toFixed(e,4),this.indicatorData.push({time:a.time,value:e}),[{id:this.uniqueID,value:e}]},EMA.prototype.update=function(a){var b=this.indicatorData.length-1,c=this.indicatorData[b-1].value,d=this.indicators.getIndicatorOrPriceValue(a,this.options.appliedTo),e=2*d/(this.options.period+1)+c*(1-2/(this.options.period+1));return e=toFixed(e,4),this.indicatorData[b].value=e,[{id:this.uniqueID,value:e}]},EMA.prototype.toString=function(){return"EMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},FRACTAL=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.BULL=1,this.BEAR=2,this.middleBar_shift=0|Math.floor(this.options.numberOfBars/2),this.BULL_IMAGE_URL="url(images/indicators/down_fractal.svg)",this.BEAR_IMAGE_URL="url(images/indicators/up_fractal.svg)",this.CalculateFRACTALValue=function(a,b,c){if(b-this.middleBar_shift<0||b+this.middleBar_shift>a.length-1)return null;var d=a[b].high,e=a[b].low,f=_.range(b-this.middleBar_shift,b+this.middleBar_shift+1).map(function(b){return a[b]}),g=f.map(function(a){return a.low}),h=f.map(function(a){return a.high}),i=_.min(g),j=_.max(h),k=i===e,l=j===d,m=e;return c===this.BEAR&&(m=d),new FractalUpdateObject(a[b].time||a[b].x,m,k&&c===this.BULL||l&&c===this.BEAR?" ":"","Fractal: "+m,{symbol:c===this.BULL?this.BULL_IMAGE_URL:c===this.BEAR?this.BEAR_IMAGE_URL:null},k&&c===this.BULL,l&&c===this.BEAR)};for(var d=0;d<a.length;d++){this.priceData.push(a[d]);var e=this;[this.BULL,this.BEAR].forEach(function(b){var c=e.CalculateFRACTALValue(a,d,b);c&&!_.isEmpty(c.text)&&!_.isEmpty(c.title)&&c.marker&&c.marker.symbol&&e.indicatorData.push(c)})}this.addOrUpdateFractalData=function(a){var b=this.priceData.length-1-this.middleBar_shift,c=this,d=[];return[this.BULL,this.BEAR].forEach(function(e){var f=c.CalculateFRACTALValue(c.priceData,b,e);f&&f.marker&&f.marker.symbol&&"add"===a&&(c.indicatorData.push(f),d.push({id:c.uniqueID,value:f})),"update"===a&&d.push({id:c.uniqueID,value:f})}),d}},FractalUpdateObject=function(a,b,c,d,e,f,g){this.y=b,this.x=a,this.title=c,this.text=d,this.marker=e,this.isBull=f,this.isBear=g,this.toJSObject=function(){return{x:a,y:b,title:c,text:d,marker:e}}},FRACTAL.prototype=Object.create(IndicatorBase.prototype),FRACTAL.prototype.constructor=FRACTAL,FRACTAL.prototype.addPoint=function(a){return this.priceData.push(a),this.addOrUpdateFractalData("add")},FRACTAL.prototype.update=function(a){var b=this.priceData.length-1;return this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close,this.addOrUpdateFractalData("update")},FRACTAL.prototype.toString=function(){return"FRACTAL ("+this.options.numberOfBars+")"},FRACTAL.prototype.buildSeriesAndAxisConfFromData=function(a){return[{seriesConf:{id:this.uniqueID,name:this.toString(),data:this.indicatorData,type:"scatter",turboThreshold:0,onChartIndicator:a.onChartIndicator,enableMouseTracking:!1,onSeries:this.options.onSeriesID}}]},HMA=function(a,b,c){IndicatorBase.call(this,a,b,c),this.someTypeOfMa1=null,this.someTypeOfMa2=null,this.someTypeOfMa3=null;var d=(b.maType||"sma").toUpperCase(),e=0|Math.round(b.period/2);this.someTypeOfMa1=new window[d](a,{period:e,appliedTo:b.appliedTo},c),this.someTypeOfMa2=new window[d](a,{period:b.period,appliedTo:b.appliedTo},c);for(var f=[],g=0;g<a.length;g++){var h=this.someTypeOfMa1.indicatorData[g].value,i=this.someTypeOfMa2.indicatorData[g].value,j=2*h-i;f.push({time:a[g].time,close:j})}var k=0|Math.round(Math.sqrt(b.period));this.someTypeOfMa3=new window[d](f,{period:k,appliedTo:c.CLOSE},c),this.indicatorData=this.someTypeOfMa3.indicatorData,this.indicatorData.forEach(function(a){0===a.value&&(a.value=null)})},HMA.prototype=Object.create(IndicatorBase.prototype),HMA.prototype.constructor=HMA,HMA.prototype.addPoint=function(a){var b=this.someTypeOfMa1.addPoint(a)[0].value,c=this.someTypeOfMa2.addPoint(a)[0].value,d=2*b-c,e=this.someTypeOfMa3.addPoint({time:a.time,close:d})[0].value;return this.indicatorData=this.someTypeOfMa3.indicatorData,[{id:this.uniqueID,value:e}]},HMA.prototype.update=function(a){var b=this.someTypeOfMa1.update(a)[0].value,c=this.someTypeOfMa2.update(a)[0].value,d=2*b-c,e=this.someTypeOfMa3.update({time:a.time,close:d})[0].value;return this.indicatorData=this.someTypeOfMa3.indicatorData,[{id:this.uniqueID,value:e}]},HMA.prototype.toString=function(){return"HMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+", "+this.options.maType+")"},define(["jquery","lodash","common/util","highcharts-more"],function(a,b){function c(a,c){var d=c.data;if(a.value&&b.isFunction(a.value.toJSObject)){var e=a.value.x,f=b.find(d,function(c){var d=b.isNumber(e)&&e>0&&e===c.x;return d&&a.value.marker&&(d=a.value.marker.symbol===c.marker.symbol),d});f&&f.remove(),b.isNumber(e)&&e>0&&!b.isEmpty(a.value.text)&&!b.isEmpty(a.value.title)&&c.addPoint(a.value)}}var d=[];require(["text!charts/indicators/indicators.json"],function(a){d=b.cloneDeep(JSON.parse(a))});var e={OPEN:0,HIGH:1,LOW:2,CLOSE:3,initHighchartIndicators:function(f){Highcharts.Series.prototype.addIndicator=function(c,g){var h=f.chain().find({instrumentCdAndTp:this.options.id}).simplesort("time",!1).data(),i=new(window[b.startsWith(c.toUpperCase(),"CDL")?"CDL":c.toUpperCase()])(h,g,e),j=this,k=j.chart,l=d[c];if(l){var m=i.buildSeriesAndAxisConfFromData(l);m.forEach(function(a){if(a.axisConf&&(k.addAxis(a.axisConf,!1,!1,!1),e.recalculate(k)),a.seriesConf){var c=b.extend(a.seriesConf,{dataGrouping:j.options.dataGrouping,opposite:j.options.opposite});l.onChartIndicator&&(c=b.extend(c,{compare:j.options.compare})),k.addSeries(c,!1,!1)}}),k.redraw(),this[c]=this[c]||[],this[c].push(i)}var n=k.renderTo.id.replace("_chart",""),o=a("#"+n);o.trigger("chart-indicators-changed",k)},Highcharts.Series.prototype.removeIndicator=function(b){var c=this;if(c.options.isInstrument&&"navigator"!==c.options.id)for(var f in d){var g=d[f];c[g.id]&&c[g.id].forEach(function(a,d){return a.isSameInstance(b)?(b.forEach(function(a){var b=c.chart.get(a);b&&b.remove(!1),b=c.chart.get(g.id+"-"+a),b&&(b.remove(!1),e.recalculate(c.chart))}),c[g.id].splice(d,1),!1):void 0})}this.chart.redraw();var h=this.chart.renderTo.id.replace("_chart",""),i=a("#"+h);i.trigger("chart-indicators-changed",this.chart)},Highcharts.wrap(Highcharts.Series.prototype,"addPoint",function(a,e,g,h,i){a.call(this,e,g,h,i);var j=this;if(j.options.isInstrument&&"navigator"!==j.options.id){var k=e[0],l=(f.chain().find({$and:[{instrumentCdAndTp:j.options.id},{time:k}]}).simplesort("time",!0).limit(1).data()||[])[0];if(l)for(var m in d){var n=d[m];j[n.id]&&j[n.id].forEach(function(a){var d=a.addPoint(l);d.forEach(function(a){var d=j.chart.get(a.id);b.isArray(a.value)?d.addPoint(b.flattenDeep([k,a.value])):a.value instanceof CDLUpdateObject||a.value instanceof FractalUpdateObject?c(a,d):a.color?(d.addPoint([k,a.value]),d.data[d.data.length-1].update({color:a.color})):d.addPoint([k,a.value])})})}}}),Highcharts.wrap(Highcharts.Point.prototype,"update",function(a,e,g,h){a.call(this,e,g,h);var i=this.series;if(i.options.isInstrument&&"navigator"!==i.options.id){var j=this.x||this.time,k=(f.chain().find({$and:[{instrumentCdAndTp:i.options.id},{time:j}]}).simplesort("time",!0).limit(1).data()||[])[0];if(k)for(var l in d){var m=d[l];i[m.id]&&i[m.id].forEach(function(a){var d=a.update(k);d.forEach(function(a){var d=i.chart.get(a.id),e=d.data;b.isArray(a.value)?e[e.length-1].update(b.flattenDeep([j,a.value])):a.value instanceof CDLUpdateObject||a.value instanceof FractalUpdateObject?c(a,d):e[e.length-1].update({y:a.value})})})}}})},recalculate:function(b){var c=5,d=b.yAxis.length;d--,d--;var e=Math.round(45/d)-5,f=0;0>=d?b.yAxis[0].update({top:"0%",height:"100%"},!1):a.each(b.yAxis,function(a,b){0==a?(b.update({top:"0%",height:"50%"},!1),f+=50):b.options&&b.options.id&&-1!=b.options.id.toLowerCase().indexOf("navigator")||(b.update({top:f+c+"%",height:(f+c+e>100?100-f-c:e)+"%",offset:0},!1),f+=c+e)})},appliedPriceString:function(a){var b="CLOSE";switch(a){case e.OPEN:b="OPEN";break;case e.HIGH:b="HIGH";break;case e.LOW:b="LOW";break;case e.CLOSE:b="CLOSE"}return b},getIndicatorOrPriceValue:function(a,b){var c=a.close;switch(b){case this.OPEN:c=a.open;break;case this.HIGH:c=a.high;break;case this.LOW:c=a.low}return c},isLongCandle:function(a,b,c,d){var e=Math.abs(a-d),f=Math.abs(b-c);return e>=.7*f},getIndicatorsJSONData:function(){return d}};return e}),KAMA=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.CalculateKAMAValue=function(a,b){for(var c=2/(this.options.fastPeriod+1),d=2/(this.options.slowPeriod+1),e=Math.abs(this.indicators.getIndicatorOrPriceValue(a[b],this.options.appliedTo)-this.indicators.getIndicatorOrPriceValue(this.priceData[b-this.options.period],this.options.appliedTo)),f=0,g=0;g<this.options.period;g++)f+=Math.abs(this.indicators.getIndicatorOrPriceValue(a[b-g],this.options.appliedTo)-this.indicators.getIndicatorOrPriceValue(this.priceData[b-(g+1)],this.options.appliedTo));var h=e/f,i=Math.pow(h*(c-d)+d,2),j=this.indicators.getIndicatorOrPriceValue(a[b],this.options.appliedTo),k=this.indicatorData[b-1].value,l=toFixed(k+i*(j-k),4);return l};for(var d=0;d<a.length;d++){if(d>this.options.period-1){var e=this.CalculateKAMAValue(a,d);this.indicatorData.push({time:a[d].time,value:e})}else if(d===this.options.period-1){var e=toFixed(c.getIndicatorOrPriceValue(a[d],this.options.appliedTo),4);this.indicatorData.push({time:a[d].time,value:null})}else this.indicatorData.push({time:a[d].time,value:null});this.priceData.push(a[d])}},KAMA.prototype=Object.create(IndicatorBase.prototype),KAMA.prototype.constructor=KAMA,KAMA.prototype.addPoint=function(a){this.priceData.push(a);var b=this.CalculateKAMAValue(this.priceData,this.priceData.length-1);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},KAMA.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.CalculateKAMAValue(this.priceData,b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},KAMA.prototype.toString=function(){return"KAMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},LSMA=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.CalculateLSMAValue=function(a,b){for(var c=0,d=0,e=0,f=0;f<this.options.period;f++){var g=this.indicators.getIndicatorOrPriceValue(a[b-f],this.options.appliedTo);d+=g,c+=b-f,e+=g*(b-f)}var h=(this.options.period*e-c*d)/(this.options.period*c-Math.pow(c,2)),i=1/this.options.period,j=i*d-h*i*c,k=h*b+j;return toFixed(k,4)};for(var d=0;d<a.length;d++){if(d>=this.options.period){var e=this.CalculateLSMAValue(a,d);this.indicatorData.push({time:a[d].time,value:e})}else this.indicatorData.push({time:a[d].time,value:null});this.priceData.push(a[d])}},LSMA.prototype=Object.create(IndicatorBase.prototype),LSMA.prototype.constructor=LSMA,LSMA.prototype.addPoint=function(a){this.priceData.push(a);var b=this.CalculateLSMAValue(this.priceData,this.priceData.length-1);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},LSMA.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.CalculateLSMAValue(this.priceData,b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},LSMA.prototype.toString=function(){return"LSMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},LWMA=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[];for(var d=0;d<a.length;d++){if(d>=this.options.period-1){for(var e=0,f=0,g=this.options.period-1;g>=0;g--)e+=c.getIndicatorOrPriceValue(a[d-g],this.options.appliedTo)*(d-g),f+=d-g;var h=toFixed(e/f,4);this.indicatorData.push({time:a[d].time,value:h})}else this.indicatorData.push({time:a[d].time,value:null});this.priceData.push(a[d])}},LWMA.prototype=Object.create(IndicatorBase.prototype),LWMA.prototype.constructor=LWMA,LWMA.prototype.addPoint=function(a){this.priceData.push(a);for(var b=0,c=0,d=this.options.period-1;d>=0;d--){var e=this.priceData.length-1;b+=this.indicators.getIndicatorOrPriceValue(this.priceData[e-d],this.options.appliedTo)*(e-d),c+=e-d}var f=toFixed(b/c,4);return this.indicatorData.push({time:a.time,value:f}),[{id:this.uniqueID,value:f}]},LWMA.prototype.update=function(a){var b=0,c=0,d=this.priceData.length-1;this.priceData[d].open=a.open,this.priceData[d].high=a.high,this.priceData[d].low=a.low,this.priceData[d].close=a.close;for(var e=this.options.period-1;e>=0;e--)b+=this.indicators.getIndicatorOrPriceValue(this.priceData[d-e],this.options.appliedTo)*(d-e),c+=d-e;var f=toFixed(b/c,4);return this.indicatorData[d].value=f,[{id:this.uniqueID,value:f}]},LWMA.prototype.toString=function(){return"LWMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},MACD=function(a,b,c){b.fastMaType=(b.fastMaType||"SMA").toUpperCase(),b.slowMaType=(b.slowMaType||"SMA").toUpperCase(),b.signalMaType=(b.signalMaType||"SMA").toUpperCase(),IndicatorBase.call(this,a,b,c);var d={maType:b.slowMaType,period:b.slowPeriod,appliedTo:b.appliedTo},e={maType:b.fastMaType,period:b.fastPeriod,appliedTo:b.appliedTo},f={maType:b.signalMaType,period:b.signalPeriod+b.slowPeriod-1};this.fastMa=new window[b.fastMaType](a,e,c),this.slowMa=new window[b.slowMaType](a,d,c),this.histogramData=[],this.uniqueID=[uuid(),uuid(),uuid()];for(var g=0;g<a.length;g++){var h=toFixed(this.fastMa.indicatorData[g].value-this.slowMa.indicatorData[g].value,4);this.indicatorData.push({time:a[g].time,value:h,close:h})}this.signalMa=new window[b.signalMaType](this.indicatorData,f,c),this.signalData=this.signalMa.indicatorData;var g=0,i=this;this.indicatorData.forEach(function(b){var c=toFixed(b.value-i.signalData[g].value,4);i.histogramData.push({time:a[g].time,value:c}),g++})},MACD.prototype=Object.create(IndicatorBase.prototype),MACD.prototype.constructor=MACD,MACD.prototype.addPoint=function(a){var b=this.fastMa.addPoint(a)[0].value,c=this.slowMa.addPoint(a)[0].value,d=toFixed(b-c,4),e=this.signalMa.addPoint({time:a.time,close:d})[0].value,f=toFixed(d-e,4);return this.signalData=this.signalMa.indicatorData,this.histogramData.push({time:a.time,value:f}),this.indicatorData.push({time:a.time,value:d}),[{id:this.uniqueID[0],value:d},{id:this.uniqueID[1],value:e},{id:this.uniqueID[2],value:f}]},MACD.prototype.update=function(a){var b=this.indicatorData.length-1,c=this.fastMa.update(a)[0].value,d=this.slowMa.update(a)[0].value,e=toFixed(c-d,4),f=this.signalMa.update({time:a.time,close:e})[0].value,g=toFixed(e-f,4);return this.signalData=this.signalMa.indicatorData,this.histogramData[b].value=g,this.indicatorData[b].value=e,[{id:this.uniqueID[0],value:e},{id:this.uniqueID[1],value:f},{id:this.uniqueID[2],value:g}]},MACD.prototype.toString=function(){return"MACD ("+this.options.fastPeriod+", "+this.options.slowPeriod+", "+this.options.signalPeriod+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},MACD.prototype.buildSeriesAndAxisConfFromData=function(a){var b=[];this.indicatorData.forEach(function(a){b.push([a.time,a.value])});var c=[];this.signalData.forEach(function(a){c.push([a.time,a.value])});var d=[];return this.histogramData.forEach(function(a){d.push([a.time,a.value])}),[{axisConf:{id:a.id+"-"+this.uniqueID[0],title:{text:this.toString(),align:"high",offset:0,rotation:0,y:10,x:30+7.5*this.toString().length},lineWidth:2,plotLines:this.options.levels}},{seriesConf:{id:this.uniqueID[2],name:"Histogram - "+this.toString(),data:d,type:"column",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.stroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}},{seriesConf:{id:this.uniqueID[0],name:"MACD - "+this.toString(),data:b,type:"line",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.stroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}},{seriesConf:{id:this.uniqueID[1],name:"SIGNAL - "+this.toString(),data:c,type:"line",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.stroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}}]},MACD.prototype.getIDs=function(){return this.uniqueID},MACD.prototype.isSameInstance=function(a){return _.isEqual(a.sort(),this.uniqueID)},MAMA=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.smooth=[],this.detrender=[],this.period=[],this.I1=[],this.Q1=[],this.I2=[],this.Q2=[],this.Re=[],this.Im=[],this.smoothPeriod=[],this.phase=[],this.CalculateMAMAValue=function(a,b){var c=this.indicators.getIndicatorOrPriceValue(a[b],this.options.appliedTo);if(10>=b)this.smooth.push(0),this.detrender.push(0),this.I1.push(0),this.Q1.push(0),this.I2.push(0),this.Q2.push(0),this.Re.push(0),this.Im.push(0),this.period.push(0),this.smoothPeriod.push(0),this.phase.push(0);else if(b>10){this.smooth.push((4*this.indicators.getIndicatorOrPriceValue(a[b],this.options.appliedTo)+3*this.indicators.getIndicatorOrPriceValue(a[b-1],this.options.appliedTo)+2*this.indicators.getIndicatorOrPriceValue(a[b-2],this.options.appliedTo)+1*this.indicators.getIndicatorOrPriceValue(a[b-3],this.options.appliedTo))/10),this.detrender.push((.0962*this.smooth[b]+.5769*this.smooth[b-2]+.5769*this.smooth[b-4]+.0962*this.smooth[b-6])*(.075*this.period[b-1]+.054)),this.Q1.push((.0962*this.detrender[b]+.5769*this.detrender[b-2]+.5769*this.detrender[b-4]+.0962*this.detrender[b-6])*(.075*this.period[b-1]+.054)),this.I1.push(this.detrender[b-3]);var d=(.0962*this.I1[b]+.5769*this.I1[b-2]+.5769*this.I1[b-4]+.0962*this.I1[b-6])*(.075*this.period[b-1]+.054),e=(.0962*this.Q1[b]+.5769*this.Q1[b-2]+.5769*this.Q1[b-4]+.0962*this.Q1[b-6])*(.075*this.period[b-1]+.054);this.I2.push(this.I1[b]-e),this.Q2.push(this.Q1[b]+d),this.I2[b]=.2*this.I2[b]+.8*this.I2[b-1],this.Q2[b]=.2*this.Q2[b]+.8*this.Q2[b-1],this.Re.push(this.I2[b]*this.I2[b-1]+this.Q2[b]*this.Q2[b-1]),this.Im.push(this.I2[b]*this.Q2[b-1]-this.Q2[b]*this.I2[b-1]),this.Re[b]=.2*this.Re[b]+.8*this.Re[b-1],this.Im[b]=.2*this.Im[b]+.8*this.Im[b-1],this.period.push(0),0!==this.Im[b]&&0!==this.Re[b]&&(this.period[b]=360/(57.29577951307855*Math.atan(this.Im[b]/this.Re[b]))),this.period[b]>1.5*this.period[b-1]&&(this.period[b]=1.5*this.period[b-1]),this.period[b]<.67*this.period[b-1]&&(this.period[b]=.67*this.period[b-1]),this.period[b]<6&&(this.period[b]=6),this.period[b]>50&&(this.period[b]=50),this.period[b]=.2*this.period[b]+.8*this.period[b-1],this.smoothPeriod.push(.33*this.period[b]+.67*this.smoothPeriod[b-1]),this.phase.push(0),0!==this.I1[b]&&(this.phase[b]=57.29577951307855*Math.atan(this.Q1[b]/this.I1[b]));var f=this.phase[b-1]-this.phase[b];1>f&&(f=1);var g=this.options.fastLimit/f;g<this.options.slowLimit&&(g=this.options.slowLimit),g>this.options.fastLimit&&(g=this.options.fastLimit),c=g*this.indicators.getIndicatorOrPriceValue(a[b],this.options.appliedTo)+(1-g)*this.indicatorData[b-1].value}return toFixed(c,4)};for(var d=0;d<a.length;d++){var e=this.CalculateMAMAValue(a,d);this.indicatorData.push({time:a[d].time,value:e}),this.priceData.push(a[d])}},MAMA.prototype=Object.create(IndicatorBase.prototype),MAMA.prototype.constructor=MAMA,MAMA.prototype.addPoint=function(a){this.priceData.push(a);var b=this.CalculateMAMAValue(this.priceData,this.priceData.length-1);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},MAMA.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.CalculateMAMAValue(this.priceData,b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},MAMA.prototype.toString=function(){return"MAMA ("+this.indicators.appliedPriceString(this.options.appliedTo)+")"},MASS=function(a,b,c){b.singleMaType=(b.singleMaType||"SMA").toUpperCase(),b.doubleMaType=(b.doubleMaType||"SMA").toUpperCase(),IndicatorBase.call(this,a,b,c),this.calculateMassValue=function(a){for(var b=0,c=0;c<this.options.period;c++)b+=this.ratioData[a-c].value;return toFixed(b,4)};for(var d=[],e=0;e<a.length;e++){var f=a[e].high-a[e].low;d.push({time:a[e].time,close:f})}this.singleMA=new window[b.singleMaType](d,{maType:b.singleMaType,period:b.singlePeriod},c),singleMAData=[],this.singleMA.indicatorData.forEach(function(a){singleMAData.push({time:a.time,close:a.value})}),this.doubleMA=new window[b.doubleMaType](singleMAData,{maType:b.doubleMaType,period:b.doublePeriod},c);var e=0,g=this;this.ratioData=[],this.singleMA.indicatorData.forEach(function(b){var c=0;0!==g.doubleMA.indicatorData[e].value&&(c=b.value/g.doubleMA.indicatorData[e].value),g.ratioData.push({time:a[e].time,value:c}),e++});for(var e=0;e<a.length;e++)if(e>=this.options.period){var h=this.calculateMassValue(e);this.indicatorData.push({time:a[e].time,value:h})}else this.indicatorData.push({time:a[e].time,value:0})},MASS.prototype=Object.create(IndicatorBase.prototype),MASS.prototype.constructor=MASS,MASS.prototype.addPoint=function(a){var b=this.indicatorData.length-1,c=a.high-a.low,d=this.singleMA.addPoint({time:a.time,close:c})[0].value,e=this.doubleMA.addPoint({time:a.time,close:d})[0].value;this.ratioData.push({time:a.time,value:0!==e?d/e:0});var f=this.calculateMassValue(b);return this.indicatorData.push({time:a.time,value:f}),[{id:this.uniqueID,value:f}]},MASS.prototype.update=function(a){var b=this.indicatorData.length-1,c=a.high-a.low,d=this.singleMA.update({time:a.time,close:c})[0].value,e=this.doubleMA.update({time:a.time,close:d})[0].value;this.ratioData[b].value=0!==e?d/e:0;var f=this.calculateMassValue(b);return this.indicatorData[b].value=f,[{id:this.uniqueID,value:f}]},MASS.prototype.toString=function(){return"MASS ("+this.options.singlePeriod+", "+this.options.doublePeriod+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},MAX=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.CalculateMAXValue=function(a,b){for(var c=this.indicators.getIndicatorOrPriceValue(a[b],this.options.appliedTo),d=0;d<this.options.period;d++){var e=this.indicators.getIndicatorOrPriceValue(a[b-d],this.options.appliedTo);c=Math.max(c,e)}return toFixed(c,4)};for(var d=0;d<a.length;d++){if(d>=this.options.period-1){var e=this.CalculateMAXValue(a,d);this.indicatorData.push({time:a[d].time,value:e})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},MAX.prototype=Object.create(IndicatorBase.prototype),MAX.prototype.constructor=MAX,MAX.prototype.addPoint=function(a){this.priceData.push(a);var b=this.CalculateMAXValue(this.priceData,this.priceData.length-1);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},MAX.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.CalculateMAXValue(this.priceData,b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},MAX.prototype.toString=function(){return"MAX ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},MIN=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.CalculateMINValue=function(a,b){for(var c=this.indicators.getIndicatorOrPriceValue(a[b],this.options.appliedTo),d=0;d<this.options.period;d++){var e=this.indicators.getIndicatorOrPriceValue(a[b-d],this.options.appliedTo);c=Math.min(c,e)}return toFixed(c,4)};for(var d=0;d<a.length;d++){if(d>=this.options.period-1){var e=this.CalculateMINValue(a,d);this.indicatorData.push({time:a[d].time,value:e})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},MIN.prototype=Object.create(IndicatorBase.prototype),MIN.prototype.constructor=MIN,MIN.prototype.addPoint=function(a){this.priceData.push(a);var b=this.CalculateMINValue(this.priceData,this.priceData.length-1);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},MIN.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.CalculateMINValue(this.priceData,b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},MIN.prototype.toString=function(){return"MIN ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},MOM=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[];for(var d=0;d<a.length;d++){if(d>=this.options.period){var e=this.indicators.getIndicatorOrPriceValue(a[d],this.options.appliedTo),f=this.indicators.getIndicatorOrPriceValue(a[d-this.options.period],this.options.appliedTo),g=toFixed(100*(e-f),4);this.indicatorData.push({time:a[d].time,value:g})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},MOM.prototype=Object.create(IndicatorBase.prototype),MOM.prototype.constructor=MOM,MOM.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1,c=this.indicators.getIndicatorOrPriceValue(this.priceData[b],this.options.appliedTo),d=this.indicators.getIndicatorOrPriceValue(this.priceData[b-this.options.period],this.options.appliedTo),e=toFixed(100*(c-d),4);return this.indicatorData.push({time:a.time,value:e}),[{id:this.uniqueID,value:e}]},MOM.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.indicators.getIndicatorOrPriceValue(this.priceData[b],this.options.appliedTo),d=this.indicators.getIndicatorOrPriceValue(this.priceData[b-this.options.period],this.options.appliedTo),e=toFixed(100*(c-d),4);return this.indicatorData[b].value=e,[{id:this.uniqueID,value:e}]},MOM.prototype.toString=function(){return"MOM ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},PPO=function(a,b,c){b.fastMaType=(b.fastMaType||"SMA").toUpperCase(),b.slowMaType=(b.slowMaType||"SMA").toUpperCase(),b.signalMaType=(b.signalMaType||"SMA").toUpperCase(),IndicatorBase.call(this,a,b,c);var d={maType:b.slowMaType,period:b.slowPeriod,appliedTo:b.appliedTo},e={maType:b.fastMaType,period:b.fastPeriod,appliedTo:b.appliedTo},f={maType:b.signalMaType,period:b.signalPeriod+b.slowPeriod-1};this.fastMa=new window[b.fastMaType](a,e,c),this.slowMa=new window[b.slowMaType](a,d,c),this.histogramData=[],this.uniqueID=[uuid(),uuid(),uuid()];for(var g=0;g<a.length;g++){var h=0;0!==this.slowMa.indicatorData[g].value&&(h=toFixed((this.fastMa.indicatorData[g].value-this.slowMa.indicatorData[g].value)/this.slowMa.indicatorData[g].value*100,4)),this.indicatorData.push({time:a[g].time,value:h,close:h})}this.signalMa=new window[b.signalMaType](this.indicatorData,f,c),this.signalData=this.signalMa.indicatorData;var g=0,i=this;this.indicatorData.forEach(function(b){var c=toFixed(b.value-i.signalData[g].value,4);i.histogramData.push({time:a[g].time,value:c}),g++})},PPO.prototype=Object.create(IndicatorBase.prototype),PPO.prototype.constructor=PPO,PPO.prototype.addPoint=function(a){var b=this.fastMa.addPoint(a)[0].value,c=this.slowMa.addPoint(a)[0].value,d=0;0!==c&&(d=toFixed((b-c)/c*100,4));var e=this.signalMa.addPoint({time:a.time,close:d})[0].value,f=toFixed(d-e,4);return this.signalData=this.signalMa.indicatorData,this.histogramData.push({time:a.time,value:f}),this.indicatorData.push({time:a.time,value:d}),[{id:this.uniqueID[0],value:d},{id:this.uniqueID[1],value:e},{id:this.uniqueID[2],value:f}]},PPO.prototype.update=function(a){var b=this.indicatorData.length-1,c=this.fastMa.update(a)[0].value,d=this.slowMa.update(a)[0].value,e=0;0!==d&&(e=toFixed((c-d)/d*100,4));var f=this.signalMa.update({time:a.time,close:e})[0].value,g=toFixed(e-f,4);return this.signalData=this.signalMa.indicatorData,this.histogramData[b].value=g,this.indicatorData[b].value=e,[{id:this.uniqueID[0],value:e},{id:this.uniqueID[1],value:f},{id:this.uniqueID[2],value:g}]},PPO.prototype.toString=function(){return"PPO ("+this.options.fastPeriod+", "+this.options.slowPeriod+", "+this.options.signalPeriod+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},PPO.prototype.buildSeriesAndAxisConfFromData=function(a){
var b=[];this.indicatorData.forEach(function(a){b.push([a.time,a.value])});var c=[];this.signalData.forEach(function(a){c.push([a.time,a.value])});var d=[];return this.histogramData.forEach(function(a){d.push([a.time,a.value])}),[{axisConf:{id:a.id+"-"+this.uniqueID[0],title:{text:this.toString(),align:"high",offset:0,rotation:0,y:10,x:30+7.5*this.toString().length},lineWidth:2,plotLines:this.options.levels}},{seriesConf:{id:this.uniqueID[2],name:"Histogram - "+this.toString(),data:d,type:"column",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.ppoHstgrmColor,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}},{seriesConf:{id:this.uniqueID[0],name:"PPO - "+this.toString(),data:b,type:"line",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.ppoStroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}},{seriesConf:{id:this.uniqueID[1],name:"SIGNAL - "+this.toString(),data:c,type:"line",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.signalLineStroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}}]},PPO.prototype.getIDs=function(){return this.uniqueID},PPO.prototype.isSameInstance=function(a){return _.isEqual(a.sort(),this.uniqueID)},ROC=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[];for(var d=0;d<a.length;d++){if(d>=this.options.period){var e=this.indicators.getIndicatorOrPriceValue(a[d],this.options.appliedTo),f=this.indicators.getIndicatorOrPriceValue(a[d-this.options.period],this.options.appliedTo),g=toFixed((e-f)/f*100,4);this.indicatorData.push({time:a[d].time,value:g})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},ROC.prototype=Object.create(IndicatorBase.prototype),ROC.prototype.constructor=ROC,ROC.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1,c=this.indicators.getIndicatorOrPriceValue(this.priceData[b],this.options.appliedTo),d=this.indicators.getIndicatorOrPriceValue(this.priceData[b-this.options.period],this.options.appliedTo),e=toFixed((c-d)/d*100,4);return this.indicatorData.push({time:a.time,value:e}),[{id:this.uniqueID,value:e}]},ROC.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.indicators.getIndicatorOrPriceValue(this.priceData[b],this.options.appliedTo),d=this.indicators.getIndicatorOrPriceValue(this.priceData[b-this.options.period],this.options.appliedTo),e=toFixed((c-d)/d*100,4);return this.indicatorData[b].value=e,[{id:this.uniqueID,value:e}]},ROC.prototype.toString=function(){return"ROC ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},RSI=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.CalculateRSIValue=function(a,b){for(var c=0,d=0,e=0;e<this.options.period;e++){var f=this.indicators.getIndicatorOrPriceValue(a[b-(e+1)],this.options.appliedTo),g=this.indicators.getIndicatorOrPriceValue(a[b-e],this.options.appliedTo);g>f&&(c+=g-f),f>g&&(d+=f-g)}c/=this.options.period,d/=this.options.period;var h=c/d;return toFixed(0==d?100:100-100/(1+h),4)};for(var d=0;d<a.length;d++){if(d>=this.options.period){var e=this.CalculateRSIValue(a,d);this.indicatorData.push({time:a[d].time,value:e})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},RSI.prototype=Object.create(IndicatorBase.prototype),RSI.prototype.constructor=RSI,RSI.prototype.addPoint=function(a){this.priceData.push(a);var b=this.CalculateRSIValue(this.priceData,this.priceData.length-1);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},RSI.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.CalculateRSIValue(this.priceData,b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},RSI.prototype.toString=function(){return"RSI ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},SAR=function(a,b,c){IndicatorBase.call(this,a,b,c),this.ep=[],this.af=[],this.trend=[],this.period=5,this.priceData=[],this.calculateSAR=function(a,b,c){var d=a[b].high,e=a[b].low,f=0;if(this.trend[b-2].value===this.trend[b-1].value){var g=this.indicatorData[b-1].value+this.af[b-1].value*(this.ep[b-1].value-this.indicatorData[b-1].value);if("UP"===this.trend[b-1].value){var h=Math.min(a[b-1].low,a[b-2].low);f=h>g?g:h}else{var i=Math.max(a[b-1].high,a[b-2].high);f=g>i?i:g}}else f=this.ep[b-1].value;var j="UP"===this.trend[b-1].value?d>this.ep[b-1].value?d:this.ep[b-1].value:e<this.ep[b-1].value?e:this.ep[b-1].value;c?this.ep.push({time:a[b].time,value:j}):this.ep[b]={time:a[b].time,value:j};var k="";"UP"===this.trend[b-1].value?k=e>f?"UP":"DOWN":"DOWN"===this.trend[b-1].value&&(k=f>d?"DOWN":"UP"),c?this.trend.push({time:a[b].time,value:k}):this.trend[b]={time:a[b].time,value:k};var l=0;return l=this.trend[b].value===this.trend[b-1].value?"UP"===this.trend[b].value?this.ep[b].value>this.ep[b-1].value?Math.min(this.af[b-1].value+this.options.acceleration,this.options.maximum):this.af[b-1].value:this.ep[b].value<this.ep[b-1].value?Math.min(this.af[b-1].value+this.options.acceleration,this.options.maximum):this.af[b-1].value:this.options.acceleration,c?this.af.push({time:a[b].time,value:l}):this.af[b]={time:a[b].time,value:l},toFixed(f,4)};for(var d=0;d<a.length;d++){if(d<this.period)this.ep.push({time:a[d].time,value:0}),this.af.push({time:a[d].time,value:this.options.acceleration}),this.trend.push(d===this.period-1?{time:a[d].time,value:"UP"}:{time:a[d].time,value:""}),this.indicatorData.push({time:a[d].time,value:0});else if(d===this.period){for(var e=0,f=0,g=0;g<this.period;g++){var h=a[d].high,i=a[d].low;0===e&&(e=h),e=Math.min(e,i,h),f=Math.max(e,i,h)}this.ep.push({time:a[d].time,value:f}),this.af.push({time:a[d].time,value:this.options.acceleration});var j="UP";"UP"===this.trend[d-1].value?j=i>e?"UP":"DOWN":"DOWN"===this.trend[d-1].value&&(j=e>h?"DOWN":"UP"),this.trend.push({time:a[d].time,value:j}),this.indicatorData.push({time:a[d].time,value:toFixed(e,4)})}else{var e=this.calculateSAR(a,d,!1);this.indicatorData.push({time:a[d].time,value:e})}this.priceData.push(a[d])}},SAR.prototype=Object.create(IndicatorBase.prototype),SAR.prototype.constructor=SAR,SAR.prototype.addPoint=function(a){this.priceData.push(a);var b=this.calculateSAR(this.priceData,this.priceData.length-1,!1);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},SAR.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.calculateSAR(this.priceData,b,!0);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},SAR.prototype.toString=function(){return"SAR ("+this.indicators.appliedPriceString(this.options.appliedTo)+")"},SAR.prototype.buildSeriesAndAxisConfFromData=function(){var a=[];return this.indicatorData.forEach(function(b){a.push([b.time,b.value])}),[{seriesConf:{id:this.uniqueID,name:"SAR ("+this.options.acceleration+","+this.options.maximum+")",data:a,lineWidth:0,marker:{enabled:!0},color:this.options.stroke,states:{hover:{enabled:!1}},onChartIndicator:!0}}]},SMA=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[];for(var d=0;d<a.length;d++){if(d>=this.options.period-1){for(var e=0,f=this.options.period-1;f>=0;f--)e+=c.getIndicatorOrPriceValue(a[d-f],this.options.appliedTo);var g=toFixed(e/this.options.period,4);this.indicatorData.push({time:a[d].time,value:g})}else this.indicatorData.push({time:a[d].time,value:null});this.priceData.push(a[d])}},SMA.prototype=Object.create(IndicatorBase.prototype),SMA.prototype.constructor=SMA,SMA.prototype.addPoint=function(a){this.priceData.push(a);for(var b=0,c=this.options.period-1;c>=0;c--)b+=this.indicators.getIndicatorOrPriceValue(this.priceData[this.priceData.length-1-c],this.options.appliedTo);var d=toFixed(b/this.options.period,4);return this.indicatorData.push({time:a.time,value:d}),[{id:this.uniqueID,value:d}]},SMA.prototype.update=function(a){var b=0,c=this.priceData.length-1;this.priceData[c].open=a.open,this.priceData[c].high=a.high,this.priceData[c].low=a.low,this.priceData[c].close=a.close;for(var d=this.options.period-1;d>=0;d--)b+=this.indicators.getIndicatorOrPriceValue(this.priceData[c-d],this.options.appliedTo);var e=toFixed(b/this.options.period,4);return this.indicatorData[c].value=e,[{id:this.uniqueID,value:e}]},SMA.prototype.toString=function(){return"SMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},SMMA=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.CalculateSMMAValue=function(a,b){var c=this.indicatorData[b-1].value||0,d=c*this.options.period,e=(d-c+this.indicators.getIndicatorOrPriceValue(a[b],this.options.appliedTo))/this.options.period;return toFixed(e,4)};for(var d=0;d<a.length;d++){if(d>this.options.period-1){var e=this.CalculateSMMAValue(a,d);this.indicatorData.push({time:a[d].time,value:e})}else if(d===this.options.period-1){for(var f=0,g=0;g<this.options.period;g++)f+=this.indicators.getIndicatorOrPriceValue(a[g],this.options.appliedTo);var e=toFixed(f/this.options.period,4);this.indicatorData.push({time:a[d].time,value:e})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}this.indicatorData.forEach(function(a){0===a.value&&(a.value=null)})},SMMA.prototype=Object.create(IndicatorBase.prototype),SMMA.prototype.constructor=SMMA,SMMA.prototype.addPoint=function(a){this.priceData.push(a);var b=this.CalculateSMMAValue(this.priceData,this.priceData.length-1);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},SMMA.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.CalculateSMMAValue(this.priceData,b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},SMMA.prototype.toString=function(){return"SMMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},STOCH=function(a,b,c){b.fastDMaType=(b.fastDMaType||"SMA").toUpperCase(),IndicatorBase.call(this,a,b,c),this.priceData=[],this.uniqueID=[uuid(),uuid()],this.calculateStochValue=function(a,b){for(var c=a[b].low,d=a[b].high,e=0;e<this.options.fastKPeriod;e++)c=Math.min(a[b-e].low,c),d=Math.max(a[b-e].high,d);var f=0;return d-c!==0&&(f=(this.indicators.getIndicatorOrPriceValue(a[b],this.options.appliedTo)-c)/(d-c)*100),toFixed(f,4)};for(var d=0;d<a.length;d++){if(d>=this.options.fastKPeriod){var e=this.calculateStochValue(a,d);this.indicatorData.push({time:a[d].time,value:e,close:e})}else this.indicatorData.push({time:a[d].time,value:0,close:0});this.priceData.push(a[d])}this.dData=new window[b.fastDMaType](this.indicatorData,{period:this.options.fastDPeriod,maType:this.options.fastDMaType},c)},STOCH.prototype=Object.create(IndicatorBase.prototype),STOCH.prototype.constructor=STOCH,STOCH.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1,c=this.calculateStochValue(this.priceData,b),d=this.dData.addPoint({time:a.time,close:c})[0].value;return this.indicatorData.push({time:a.time,value:c}),[{id:this.uniqueID[0],value:c},{id:this.uniqueID[1],value:d}]},STOCH.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.calculateStochValue(this.priceData,b),d=this.dData.update({time:a.time,close:c})[0].value;return this.indicatorData[b].value=c,[{id:this.uniqueID[0],value:c},{id:this.uniqueID[1],value:d}]},STOCH.prototype.toString=function(){return"STOCH ("+this.options.fastKPeriod+", "+this.options.fastDPeriod+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},STOCH.prototype.buildSeriesAndAxisConfFromData=function(a){var b=[];this.indicatorData.forEach(function(a){b.push([a.time,a.value])});var c=[];return this.dData.indicatorData.forEach(function(a){c.push([a.time,a.value])}),[{axisConf:{id:a.id+"-"+this.uniqueID[0],title:{text:this.toString(),align:"high",offset:0,rotation:0,y:10,x:30+7.5*this.toString().length},lineWidth:2,plotLines:this.options.levels}},{seriesConf:{id:this.uniqueID[0],name:this.toString(),data:b,type:"line",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.stroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}},{seriesConf:{id:this.uniqueID[1],name:"%D",data:c,type:"line",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.dStroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}}]},STOCH.prototype.getIDs=function(){return this.uniqueID},STOCH.prototype.isSameInstance=function(a){return _.isEqual(a.sort(),this.uniqueID)},STOCHF=function(a,b,c){b.fastKMaType=(b.fastKMaType||"SMA").toUpperCase(),b.fastDMaType=(b.fastDMaType||"SMA").toUpperCase(),IndicatorBase.call(this,a,b,c),this.uniqueID=[uuid(),uuid()],this.stoch=new STOCH(a,{fastKPeriod:this.options.fastKPeriod,fastDPeriod:this.options.fastDPeriod,appliedTo:this.options.appliedTo},c),this.kMa=new window[this.options.fastKMaType](this.stoch.indicatorData,{period:this.options.fastKPeriod,maType:this.options.fastKMaType},c),this.indicatorData=this.kMa.indicatorData,this.kData=[];var d=this;this.indicatorData.forEach(function(a){d.kData.push({time:a.time,close:a.value})}),this.dData=new window[b.fastDMaType](this.kData,{period:this.options.fastDPeriod,maType:this.options.fastDMaType},c)},STOCHF.prototype=Object.create(IndicatorBase.prototype),STOCHF.prototype.constructor=STOCHF,STOCHF.prototype.addPoint=function(a){var b=this.stoch.addPoint(a)[0].value,c=this.kMa.addPoint({time:a.time,close:b})[0].value;this.indicatorData=this.kMa.indicatorData;var d=this.dData.addPoint({time:a.time,close:c})[0].value;return[{id:this.uniqueID[0],value:c},{id:this.uniqueID[1],value:d}]},STOCHF.prototype.update=function(a){var b=this.stoch.update(a)[0].value,c=this.kMa.update({time:a.time,close:b})[0].value;this.indicatorData=this.kMa.indicatorData;var d=this.dData.update({time:a.time,close:c})[0].value;return[{id:this.uniqueID[0],value:c},{id:this.uniqueID[1],value:d}]},STOCHF.prototype.toString=function(){return"STOCHF ("+this.options.fastKPeriod+", "+this.options.fastDPeriod+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},STOCHF.prototype.buildSeriesAndAxisConfFromData=function(a){var b=[];this.indicatorData.forEach(function(a){b.push([a.time,a.value])});var c=[];return this.dData.indicatorData.forEach(function(a){c.push([a.time,a.value])}),[{axisConf:{id:a.id+"-"+this.uniqueID[0],title:{text:this.toString(),align:"high",offset:0,rotation:0,y:10,x:30+7.5*this.toString().length},lineWidth:2,plotLines:this.options.levels}},{seriesConf:{id:this.uniqueID[0],name:this.toString(),data:b,type:"line",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.stroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}},{seriesConf:{id:this.uniqueID[1],name:"%D",data:c,type:"line",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.dStroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}}]},STOCHF.prototype.getIDs=function(){return this.uniqueID},STOCHF.prototype.isSameInstance=function(a){return _.isEqual(a.sort(),this.uniqueID)},STOCHRSI=function(a,b,c){IndicatorBase.call(this,a,b,c),this.rsi=new window.RSI(a,b,c),this.CalculateSTOCHRSIValue=function(a){for(var b=this.rsi.indicatorData[a].value,c=this.rsi.indicatorData[a].value,d=0;d<this.options.period;d++)b=Math.max(b,this.rsi.indicatorData[a-d].value),c=Math.min(c,this.rsi.indicatorData[a-d].value);var e=0;return b-c!==0&&(e=(this.rsi.indicatorData[a].value-c)/(b-c)),toFixed(e,4)};for(var d=0;d<a.length;d++)if(d>=this.options.period){var e=this.CalculateSTOCHRSIValue(d);this.indicatorData.push({time:a[d].time,value:e})}else this.indicatorData.push({time:a[d].time,value:0})},STOCHRSI.prototype=Object.create(IndicatorBase.prototype),STOCHRSI.prototype.constructor=STOCHRSI,STOCHRSI.prototype.addPoint=function(a){this.rsi.addPoint(a);var b=this.CalculateSTOCHRSIValue(this.indicatorData.length-1);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},STOCHRSI.prototype.update=function(a){var b=this.indicatorData.length-1;this.rsi.update(a);var c=this.CalculateSTOCHRSIValue(b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},STOCHRSI.prototype.toString=function(){return" STOCHRSI ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},STOCHS=function(a,b,c){b.fastKMaType=(b.fastKMaType||"SMA").toUpperCase(),b.slowKMaType=(b.slowKMaType||"SMA").toUpperCase(),b.slowDMaType=(b.slowDMaType||"SMA").toUpperCase(),IndicatorBase.call(this,a,b,c),this.uniqueID=[uuid(),uuid()],this.stochf=new STOCHF(a,{fastKPeriod:this.options.fastKPeriod,fastKMaType:this.options.fastKMaType,appliedTo:this.options.appliedTo},c),this.kMa=new window[this.options.slowKMaType](this.stochf.kData,{period:this.options.slowKPeriod,maType:this.options.slowKMaType},c),this.indicatorData=this.kMa.indicatorData;var d=[];this.indicatorData.forEach(function(a){d.push({time:a.time,close:a.value})}),this.dData=new window[b.slowDMaType](d,{period:this.options.slowDPeriod,maType:this.options.slowDMaType},c)},STOCHS.prototype=Object.create(IndicatorBase.prototype),STOCHS.prototype.constructor=STOCHS,STOCHS.prototype.addPoint=function(a){var b=this.stochf.addPoint(a)[0].value,c=this.kMa.addPoint({time:a.time,close:b})[0].value;this.indicatorData=this.kMa.indicatorData;var d=this.dData.addPoint({time:a.time,close:c})[0].value;return[{id:this.uniqueID[0],value:c},{id:this.uniqueID[1],value:d}]},STOCHS.prototype.update=function(a){var b=this.stochf.update(a)[0].value,c=this.kMa.update({time:a.time,close:b})[0].value;this.indicatorData=this.kMa.indicatorData;var d=this.dData.update({time:a.time,close:c})[0].value;return[{id:this.uniqueID[0],value:c},{id:this.uniqueID[1],value:d}]},STOCHS.prototype.toString=function(){return"STOCHS ("+this.options.slowKPeriod+", "+this.options.slowDPeriod+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},STOCHS.prototype.buildSeriesAndAxisConfFromData=function(a){var b=[];this.indicatorData.forEach(function(a){b.push([a.time,a.value])});var c=[];return this.dData.indicatorData.forEach(function(a){c.push([a.time,a.value])}),[{axisConf:{id:a.id+"-"+this.uniqueID[0],title:{text:this.toString(),align:"high",offset:0,rotation:0,y:10,x:30+7.5*this.toString().length},lineWidth:2,plotLines:this.options.levels}},{seriesConf:{id:this.uniqueID[0],name:this.toString(),data:b,type:"line",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.stroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}},{seriesConf:{id:this.uniqueID[1],name:"%D",data:c,type:"line",yAxis:a.id+"-"+this.uniqueID[0],color:this.options.dStroke,lineWidth:this.options.strokeWidth,dashStyle:this.options.dashStyle,onChartIndicator:!1}}]},STOCHS.prototype.getIDs=function(){return this.uniqueID},STOCHS.prototype.isSameInstance=function(a){return _.isEqual(a.sort(),this.uniqueID)},SUM=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.CalculateSUMValue=function(a,b){for(var c=0,d=0;d<this.options.period;d++)c+=this.indicators.getIndicatorOrPriceValue(a[b-d],this.options.appliedTo);return toFixed(c,4)};for(var d=0;d<a.length;d++){if(d>=this.options.period-1){var e=this.CalculateSUMValue(a,d);this.indicatorData.push({time:a[d].time,value:e})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},SUM.prototype=Object.create(IndicatorBase.prototype),SUM.prototype.constructor=SUM,SUM.prototype.addPoint=function(a){this.priceData.push(a);var b=this.CalculateSUMValue(this.priceData,this.priceData.length-1);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},SUM.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.CalculateSUMValue(this.priceData,b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},SUM.prototype.toString=function(){return"SUM ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},T3=function(a,b,c){IndicatorBase.call(this,a,b,c),this.ema1={},this.ema2={},this.gd1=[],this.gd2=[],this.gd3=[],this.priceData=[],this.CalculateGD=function(a,b,c,d){this.ema1[b]=new EMA(a,{period:this.options.period,appliedTo:d},this.indicators);var e=[];this.ema1[b].indicatorData.forEach(function(a){e.push({time:a.time,close:a.value})}),this.ema2[b]=new EMA(e,{period:this.options.period,appliedTo:this.indicators.CLOSE},this.indicators);var f=[],g=0,h=this.options.vFactor;this.ema2[b].indicatorData.forEach(function(a){f.push({time:a.time,close:a.value});var b=e[g].close*(1+h)-a.value*h;c.push({time:a.time,close:b}),g++})},this.UpdateT3=function(a,b,c,d){var e=this.ema1[c].update(a)[0].value,f=this.ema2[c].update({time:a.time,close:e})[0].value,g=e*(1+this.options.vFactor)-f*this.options.vFactor;return d[b]={time:a.time,close:g},{time:a.time,close:toFixed(g,4)}},this.CalculateGD(a,"gd1",this.gd1,this.options.appliedTo),this.CalculateGD(this.gd1,"gd2",this.gd2,this.indicators.CLOSE),this.CalculateGD(this.gd2,"gd3",this.gd3,this.indicators.CLOSE);for(var d=0;d<a.length;d++)this.indicatorData.push({time:this.gd3[d].time,value:toFixed(this.gd3[d].close,4)||null}),this.priceData.push(a[d])},T3.prototype=Object.create(IndicatorBase.prototype),T3.prototype.constructor=T3,AddT3=function(a,b,c,d){var e=this.ema1[c].addPoint(a)[0].value,f=this.ema2[c].addPoint({time:a.time,close:e})[0].value,g=e*(1+this.options.vFactor)-f*this.options.vFactor;return d.push({time:a.time,close:g}),{time:a.time,close:toFixed(g,4)}},T3.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1,c=AddT3.call(this,a,b,"gd1",this.gd1),d=AddT3.call(this,c,b,"gd2",this.gd2),e=AddT3.call(this,d,b,"gd3",this.gd3);return this.indicatorData.push({time:a.time,value:e.close}),[{id:this.uniqueID,value:e.close}]},T3.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var b=this.priceData.length-1,c=this.UpdateT3(a,b,"gd1",this.gd1),d=this.UpdateT3(c,b,"gd2",this.gd2),e=this.UpdateT3(d,b,"gd3",this.gd3);return this.indicatorData.push({time:a.time,value:e.close}),[{id:this.uniqueID,value:e.close}]},T3.prototype.toString=function(){return"T3 ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},TEMA=function(a,b,c){IndicatorBase.call(this,a,b,c),this.ema1=null,this.ema2=null,this.ema3=null,this.ema1=new EMA(a,{period:b.period,appliedTo:b.appliedTo},c);var d=[];this.ema1.indicatorData.forEach(function(a){d.push({time:a.time,close:a.value})}),this.ema2=new EMA(d,{period:b.period,appliedTo:c.CLOSE},c);var e=[];this.ema2.indicatorData.forEach(function(a){e.push({time:a.time,close:a.value})}),this.ema3=new EMA(e,{period:b.period,appliedTo:c.CLOSE},c);for(var f=0;f<a.length;f++){var g=this.ema1.indicatorData[f].value,h=this.ema2.indicatorData[f].value,i=this.ema3.indicatorData[f].value,j=toFixed(3*g-3*h+i,4);this.indicatorData.push({time:a[f].time,value:j||null})}},TEMA.prototype=Object.create(IndicatorBase.prototype),TEMA.prototype.constructor=TEMA,TEMA.prototype.addPoint=function(a){var b=this.ema1.addPoint(a)[0].value,c=this.ema2.addPoint({time:a.time,close:b})[0].value,d=this.ema3.addPoint({time:a.time,close:c})[0].value,e=toFixed(3*b-3*c+d,4);return this.indicatorData.push({time:a.time,value:e}),[{id:this.uniqueID,value:e}]},TEMA.prototype.update=function(a){var b=this.indicatorData.length-1,c=this.ema1.update(a)[0].value,d=this.ema2.update({time:a.time,close:c})[0].value,e=this.ema3.update({time:a.time,close:d})[0].value,f=toFixed(3*c-3*d+e,4);return this.indicatorData[b].value=f,[{id:this.uniqueID,value:f}]},TEMA.prototype.toString=function(){return"TEMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},TRANGE=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[];for(var d=0;d<a.length;d++){if(0===d)this.indicatorData.push({time:a[d].time,value:a[d].high-a[d].low});else{var e=c.getIndicatorOrPriceValue(a[d-1],this.options.appliedTo),f=Math.max(Math.max(a[d].high-a[d].low,Math.abs(a[d].high-e)),a[d].low-e);this.indicatorData.push({time:a[d].time,value:toFixed(f,4)})}this.priceData.push(a[d])}},TRANGE.prototype=Object.create(IndicatorBase.prototype),TRANGE.prototype.constructor=TRANGE,TRANGE.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1,c=this.indicators.getIndicatorOrPriceValue(this.priceData[b-1],this.options.appliedTo),d=Math.max(Math.max(a.high-a.low,Math.abs(a.high-c)),a.low-c);return this.indicatorData.push({time:a.time,value:toFixed(d,4)}),[{id:this.uniqueID,value:d}]},TRANGE.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.indicators.getIndicatorOrPriceValue(this.priceData[b-1],this.options.appliedTo),d=Math.max(Math.max(a.high-a.low,Math.abs(a.high-c)),a.low-c);return this.indicatorData[this.indicatorData.length-1].value=toFixed(d,4),[{id:this.uniqueID,value:d}]},TRANGE.prototype.toString=function(){return"TRANGE ("+this.options.period+")"},TRIMA=function(a,b,c){IndicatorBase.call(this,a,b,c);for(var d=0|Math.round((this.options.period+1)/2),e=0;e<a.length;e++)if(e===d-1){for(var f=0,g=d-1;g>=0;g--)f+=c.getIndicatorOrPriceValue(a[e-g],this.options.appliedTo);this.indicatorData.push({time:a[e].time,value:toFixed(f/d,4)})}else if(e>d-1){var h=this.indicatorData[e-1].value,i=c.getIndicatorOrPriceValue(a[e],this.options.appliedTo),j=(h*(d-1)+i)/d;this.indicatorData.push({time:a[e].time,value:toFixed(j,4)})}else this.indicatorData.push({time:a[e].time,value:null})},TRIMA.prototype=Object.create(IndicatorBase.prototype),TRIMA.prototype.constructor=TRIMA,TRIMA.prototype.addPoint=function(a){var b=0|Math.round((this.options.period+1)/2),c=this.indicatorData.length-1,d=this.indicatorData[c].value,e=this.indicators.getIndicatorOrPriceValue(a,this.options.appliedTo),f=(d*(b-1)+e)/b;return f=toFixed(f,4),this.indicatorData.push({time:a.time,value:f}),[{id:this.uniqueID,value:f}]},TRIMA.prototype.update=function(a){var b=0|Math.round((this.options.period+1)/2),c=this.indicatorData.length-1,d=this.indicatorData[c-1].value,e=this.indicators.getIndicatorOrPriceValue(a,this.options.appliedTo),f=(d*(b-1)+e)/b;return f=toFixed(f,4),this.indicatorData[c].value=f,[{id:this.uniqueID,value:f}]},TRIMA.prototype.toString=function(){return"TRIMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},TYPPRICE=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[];for(var d=0;d<a.length;d++){var e=toFixed((a[d].high+a[d].low+a[d].close)/3,4);this.indicatorData.push({time:a[d].time,value:e}),this.priceData.push(a[d])}},TYPPRICE.prototype=Object.create(IndicatorBase.prototype),TYPPRICE.prototype.constructor=TYPPRICE,TYPPRICE.prototype.addPoint=function(a){this.priceData.push(a);var b=toFixed((a.high+a.low+a.close)/3,4);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},TYPPRICE.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=toFixed((a.high+a.low+a.close)/3,4);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},TYPPRICE.prototype.toString=function(){return"TYPPRICE ("+this.indicators.appliedPriceString(this.options.appliedTo)+")"},ULTOSC=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.BP=[],this.TR=[],this.CalculateAVG=function(a,b){for(var c=0,d=0,e=0;b>e;e++)c+=this.BP[a-e].value,d+=this.TR[a-e].value;return c/d},this.CalculateBRTRValue=function(a,b){var c=this.indicators.getIndicatorOrPriceValue(a[b],this.options.appliedTo),d=b-1>=0?this.indicators.getIndicatorOrPriceValue(a[b-1],this.options.appliedTo):0,e=c-Math.min(a[b].low,d),f=Math.max(a[b].high,d)-Math.min(a[b].low,d);return{bp:e,tr:f}};for(var d=0;d<a.length;d++){var e=this.CalculateBRTRValue(a,d);this.BP.push({time:a[d].time,value:e.bp}),this.TR.push({time:a[d].time,value:e.tr})}for(var d=0;d<a.length;d++){if(d>=this.options.thirdPeriod){var f=this.CalculateAVG(d,this.options.firstPeriod),g=this.CalculateAVG(d,this.options.secondPeriod),h=this.CalculateAVG(d,this.options.thirdPeriod),i=toFixed(100*(4*f+2*g+h)/7,4);this.indicatorData.push({time:a[d].time,value:i})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},ULTOSC.prototype=Object.create(IndicatorBase.prototype),ULTOSC.prototype.constructor=ULTOSC,ULTOSC.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1,c=this.CalculateBRTRValue(this.priceData,b);this.BP.push({time:a.time,value:c.bp}),this.TR.push({time:a.time,value:c.tr});var d=this.CalculateAVG(b,this.options.firstPeriod),e=this.CalculateAVG(b,this.options.secondPeriod),f=this.CalculateAVG(b,this.options.thirdPeriod),g=toFixed(100*(4*d+2*e+f)/7,4);return this.indicatorData.push({time:a.time,value:g}),[{id:this.uniqueID,value:g}]},ULTOSC.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.CalculateBRTRValue(this.priceData,b);this.BP[b].value=c.bp,this.TR[b].value=c.tr;var d=this.CalculateAVG(b,this.options.firstPeriod),e=this.CalculateAVG(b,this.options.secondPeriod),f=this.CalculateAVG(b,this.options.thirdPeriod),g=toFixed(100*(4*d+2*e+f)/7,4);return this.indicatorData[b].value=g,[{id:this.uniqueID,value:g}]},ULTOSC.prototype.toString=function(){return"ULTOSC ("+this.options.firstPeriod+", "+this.options.secondPeriod+", "+this.options.thirdPeriod+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"},VAR=function(a,b,c){_.isUndefined(b.appliedTo)&&(b.appliedTo=c.CLOSE),IndicatorBase.call(this,a,b,c),this.sma=new SMA(a,b,c),this.priceData=[],this.CalculateVARValue=function(a,b){for(var d=0,e=this.options.period-1;e>=0;e--)d+=Math.pow(c.getIndicatorOrPriceValue(a[b-e],this.options.appliedTo)-this.sma.indicatorData[b-e].value,2);var f=d/(this.options.period-1);return toFixed(f,4)};for(var d=0;d<a.length;d++){if(d>=b.period){var e=this.CalculateVARValue(a,d);this.indicatorData.push({time:a[d].time,value:e})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},VAR.prototype=Object.create(IndicatorBase.prototype),VAR.prototype.constructor=VAR,VAR.prototype.addPoint=function(a){this.priceData.push(a),this.sma.addPoint(a);var b=this.priceData.length-1,c=this.CalculateVARValue(this.priceData,b);return this.indicatorData.push({time:a.time,value:c}),[{id:this.uniqueID,value:c}]},VAR.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close,this.sma.update(a);var c=this.CalculateVARValue(this.priceData,b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},VAR.prototype.toString=function(){return"VAR ("+this.options.period+")"},WCLPRICE=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[];for(var d=0;d<a.length;d++){
var e=toFixed((2*a[d].close+a[d].high+a[d].low)/4,4);this.indicatorData.push({time:a[d].time,value:e}),this.priceData.push(a[d])}},WCLPRICE.prototype=Object.create(IndicatorBase.prototype),WCLPRICE.prototype.constructor=WCLPRICE,WCLPRICE.prototype.addPoint=function(a){this.priceData.push(a);var b=toFixed((2*a.close+a.high+a.low)/4,4);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},WCLPRICE.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=toFixed((2*a.close+a.high+a.low)/4,4);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},WCLPRICE.prototype.toString=function(){return"WCLPRICE ("+this.indicators.appliedPriceString(this.options.appliedTo)+")"},WMA=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[];for(var d=0;d<a.length;d++){if(d>=this.options.period-1){for(var e=0,f=d,g=this.options.period;f>=0&&g>=0;g--,f--){var h=c.getIndicatorOrPriceValue(a[f],this.options.appliedTo);e+=h*g}e/=this.options.period*(this.options.period+1)/2,e=toFixed(e,4),this.indicatorData.push({time:a[d].time,value:e})}else this.indicatorData.push({time:a[d].time,value:null});this.priceData.push(a[d])}},WMA.prototype=Object.create(IndicatorBase.prototype),WMA.prototype.constructor=WMA,WMA.prototype.addPoint=function(a){this.priceData.push(a);for(var b=this.indicatorData.length-1,c=this.indicators.getIndicatorOrPriceValue(a,this.options.appliedTo),d=this.options.period*c,e=b,f=this.options.period-1;e>=0&&f>=1;f--,e--){var c=this.indicators.getIndicatorOrPriceValue(this.priceData[e],this.options.appliedTo);d+=c*f}return d/=this.options.period*(this.options.period+1)/2,d=toFixed(d,4),this.indicatorData.push({time:a.time,value:d}),[{id:this.uniqueID,value:d}]},WMA.prototype.update=function(a){var b=this.indicatorData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;for(var c=0,d=b,e=this.options.period;d>=0&&e>=1;e--,d--){var f=this.indicators.getIndicatorOrPriceValue(this.priceData[d],this.options.appliedTo);c+=f*e}return c/=this.options.period*(this.options.period+1)/2,c=toFixed(c,4),this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},WMA.prototype.toString=function(){return"WMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"};