define(["jquery","windows/windows","websockets/binary_websockets"],function(a,b,c){var d=null;return c.events.on("login",function(e){e.authorize.is_virtual||Promise.all([c.cached.send({landing_company_details:e.authorize.landing_company_name}),c.cached.send({website_status:1}),c.send({get_settings:1})]).then(function(e){var f=e[0],g=e[1],h=e[2];f.landing_company_details&&f.landing_company_details.name&&g.website_status&&h.get_settings&&g.website_status.terms_conditions_version!==h.get_settings.client_tnc_status&&(d&&d.dialog("destroy"),require(["text!tc/tc.html","css!tc/tc.css"],function(e){var g=a(e).i18n();g.find(".tc_landing_comp_name").html(f.landing_company_details.name),g.find(".button").click(function(){c.send({tnc_approval:1}),d.dialog("destroy")}),d=b.createBlankWindow(a("<div/>"),{title:"Terms and Conditions".i18n(),width:580,minHeight:90,height:220,resizable:!1,collapsable:!1,minimizable:!1,maximizable:!1,closable:!1,modal:!0,closeOnEscape:!1,ignoreTileAction:!0,"data-authorized":"true",destroy:function(){d=null}}),g.appendTo(d),a("body").append(d.dialog("widget")),d.dialog("open")}))})}),c.events.on("login",function(){d&&d.dialog("close")}),{}});