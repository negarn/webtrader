define(["jquery","websockets/binary_websockets","navigation/menu","lodash","common/util"],function(a,b,c,d){var e=function(a,b,c,d,e,f,h){var i=a.attr("id");require(["charts/chartOptions","charts/tableView"],function(j,k){var l=k.init(a,g);j.init(i,b,c,l.show,d,e,!f,!h)})},f=new RegExp(/^(GMT[\+|-])\d{1,2}(\.\d{1,2})*$/),g=0,h=getParameterByName("timezone").toUpperCase().replace(" ","+");if(f.test(h)){var i=h.split("GMT")[1],j=parseInt(i.split(".")[0]),k=i.split(".")[1]?j>0?parseInt(i.split(".")[1]):-1*parseInt(i.split(".")[1]):0;g=-1*(60*j+k)}return Highcharts.setOptions({global:{timezoneOffset:g},plotOptions:{candlestick:{lineColor:"rgba(0,0,0,1)",color:"rgba(215,24,24,1)",upColor:"rgba(2,146,14,1)",upLineColor:"rgba(0,0,0,1)"}}}),{init:function(){a("body").addClass("affiliates"),require(["text!charts/chartWindow.html"],function(b){var c=getParameterByName("chartContainerID")||"webtrader-dialog-1",f=getParameterByName("timePeriod")||"1d",g="1t"==f?"line":"candlestick";require(["charts/charts"],function(h){var i=a(b).i18n();i.attr("id",c).find("div.chartSubContainerHeader").attr("id",c+"_header").end().find("div.chartSubContainer").attr("id",c+"_chart").end(),require(["instruments/instruments","jquery-growl"],function(b){b.init().then(function(b){if(!a.isEmptyObject(b)){var j=getParameterByName("instrument"),k=getObjects(b,"symbol",j);if(k&&k.length>0&&k[0].symbol&&k[0].display_name)if(validateParameters()){var j=k[0].symbol,l=k[0].display_name,m=k[0].delay_amount||0,n=isHideOverlay(),o=isHideShare();require(["charts/chartWindow"],function(b){var k={instrumentCode:j,instrumentName:l,timePeriod:f,type:g,delayAmount:m,name:c};b.add_chart_options(c,k),h.drawChart("#"+c+"_chart",{instrumentCode:j,instrumentName:l,timePeriod:f,type:g,delayAmount:m}),e(i,f,g,l,j,o,n),d.defer(function(){h.triggerReflow("#"+c+"_chart"),a("#"+c).on("chart-time-period-changed",function(a,b){window.timePeriodChangeListener&&window.timePeriodChangeListener(b)})})})}else require(["jquery","jquery-growl"],function(a){a.growl.error({message:"Invalid parameter(s)!".i18n()})}),i.find("div.chartSubContainerHeader").hide();else require(["jquery","jquery-growl"],function(a){a.growl.error({message:"Instrument Code Unknown/Unavailable!".i18n()})}),i.find("div.chartSubContainerHeader").hide()}})["catch"](function(a){require(["jquery","jquery-growl"],function(a){a.growl.error({message:"Error getting market information!".i18n()})}),i.find("div.chartSubContainerHeader").hide()})}),a(".mainContainer").append(i),a("#"+c+" .chartSubContainer").height(a(window).height()-50).width(a(window).width()),a("#"+c+" .table-view").width(a(window).width()),a(window).resize(function(){a("#"+c+" .chartSubContainer").height(a(window).height()-50).width(a(window).width()),a("#"+c+" .table-view").width(a(window).width())})})})}}});